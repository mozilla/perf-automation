"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.TermsAuthEntry = exports.SSOAuthEntry = exports.RecaptchaAuthEntry = exports.PasswordAuthEntry = exports.MsisdnAuthEntry = exports.FallbackAuthEntry = exports.EmailIdentityAuthEntry = exports.DEFAULT_PHASE = void 0;
exports.default = getEntryComponentForLoginType;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _interactiveAuth = require("matrix-js-sdk/src/interactive-auth");

var _languageHandler = require("../../../languageHandler");

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

var _Spinner = _interopRequireDefault(require("../elements/Spinner"));

var _CountlyAnalytics = _interopRequireDefault(require("../../../CountlyAnalytics"));

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _Field = _interopRequireDefault(require("../elements/Field"));

var _CaptchaForm = _interopRequireDefault(require("./CaptchaForm"));

var _logger = require("matrix-js-sdk/src/logger");

var _dec, _class, _class2, _temp, _dec2, _class3, _class4, _temp2, _dec3, _class5, _class6, _temp3, _dec4, _class7, _class8, _temp4, _dec5, _class9, _class10, _temp5, _dec6, _class11, _class12, _temp6, _dec7, _class13;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/* This file contains a collection of components which are used by the
 * InteractiveAuth to prompt the user to enter the information needed
 * for an auth stage. (The intention is that they could also be used for other
 * components, such as the registration flow).
 *
 * Call getEntryComponentForLoginType() to get a component suitable for a
 * particular login type. Each component requires the same properties:
 *
 * matrixClient:           A matrix client. May be a different one to the one
 *                         currently being used generally (eg. to register with
 *                         one HS whilst being a guest on another).
 * loginType:              the login type of the auth stage being attempted
 * authSessionId:          session id from the server
 * clientSecret:           The client secret in use for identity server auth sessions
 * stageParams:            params from the server for the stage being attempted
 * errorText:              error message from a previous attempt to authenticate
 * submitAuthDict:         a function which will be called with the new auth dict
 * busy:                   a boolean indicating whether the auth logic is doing something
 *                         the user needs to wait for.
 * inputs:                 Object of inputs provided by the user, as in js-sdk
 *                         interactive-auth
 * stageState:             Stage-specific object used for communicating state information
 *                         to the UI from the state-specific auth logic.
 *                         Defined keys for stages are:
 *                             m.login.email.identity:
 *                              * emailSid: string representing the sid of the active
 *                                          verification session from the identity server,
 *                                          or null if no session is active.
 * fail:                   a function which should be called with an error object if an
 *                         error occurred during the auth stage. This will cause the auth
 *                         session to be failed and the process to go back to the start.
 * setEmailSid:            m.login.email.identity only: a function to be called with the
 *                         email sid after a token is requested.
 * onPhaseChange:          A function which is called when the stage's phase changes. If
 *                         the stage has no phases, call this with DEFAULT_PHASE. Takes
 *                         one argument, the phase, and is always defined/required.
 * continueText:           For stages which have a continue button, the text to use.
 * continueKind:           For stages which have a continue button, the style of button to
 *                         use. For example, 'danger' or 'primary'.
 * onCancel                A function with no arguments which is called by the stage if the
 *                         user knowingly cancelled/dismissed the authentication attempt.
 *
 * Each component may also provide the following functions (beyond the standard React ones):
 *    focus: set the input focus appropriately in the form.
 */
const DEFAULT_PHASE = 0;
exports.DEFAULT_PHASE = DEFAULT_PHASE;
let PasswordAuthEntry = (_dec = (0, _replaceableComponent.replaceableComponent)("views.auth.PasswordAuthEntry"), _dec(_class = (_temp = _class2 = class PasswordAuthEntry extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "onSubmit", e => {
      e.preventDefault();
      if (this.props.busy) return;
      this.props.submitAuthDict({
        type: _interactiveAuth.AuthType.Password,
        // TODO: Remove `user` once servers support proper UIA
        // See https://github.com/vector-im/element-web/issues/10312
        user: this.props.matrixClient.credentials.userId,
        identifier: {
          type: "m.id.user",
          user: this.props.matrixClient.credentials.userId
        },
        password: this.state.password
      });
    });
    (0, _defineProperty2.default)(this, "onPasswordFieldChange", ev => {
      // enable the submit button iff the password is non-empty
      this.setState({
        password: ev.target.value
      });
    });
    this.state = {
      password: ""
    };
  }

  componentDidMount() {
    this.props.onPhaseChange(DEFAULT_PHASE);
  }

  render() {
    const passwordBoxClass = (0, _classnames.default)({
      "error": this.props.errorText
    });
    let submitButtonOrSpinner;

    if (this.props.busy) {
      submitButtonOrSpinner = /*#__PURE__*/_react.default.createElement(_Spinner.default, null);
    } else {
      submitButtonOrSpinner = /*#__PURE__*/_react.default.createElement("input", {
        type: "submit",
        className: "mx_Dialog_primary",
        disabled: !this.state.password,
        value: (0, _languageHandler._t)("Continue")
      });
    }

    let errorSection;

    if (this.props.errorText) {
      errorSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "error",
        role: "alert"
      }, this.props.errorText);
    }

    return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Confirm your identity by entering your account password below.")), /*#__PURE__*/_react.default.createElement("form", {
      onSubmit: this.onSubmit,
      className: "mx_InteractiveAuthEntryComponents_passwordSection"
    }, /*#__PURE__*/_react.default.createElement(_Field.default, {
      className: passwordBoxClass,
      type: "password",
      name: "passwordField",
      label: (0, _languageHandler._t)('Password'),
      autoFocus: true,
      value: this.state.password,
      onChange: this.onPasswordFieldChange
    }), errorSection, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_button_row"
    }, submitButtonOrSpinner)));
  }

}, (0, _defineProperty2.default)(_class2, "LOGIN_TYPE", _interactiveAuth.AuthType.Password), _temp)) || _class);
/* eslint-disable camelcase */

exports.PasswordAuthEntry = PasswordAuthEntry;

/* eslint-enable camelcase */
let RecaptchaAuthEntry = (_dec2 = (0, _replaceableComponent.replaceableComponent)("views.auth.RecaptchaAuthEntry"), _dec2(_class3 = (_temp2 = _class4 = class RecaptchaAuthEntry extends _react.default.Component {
  constructor(...args) {
    super(...args);
    (0, _defineProperty2.default)(this, "onCaptchaResponse", response => {
      _CountlyAnalytics.default.instance.track("onboarding_grecaptcha_submit");

      this.props.submitAuthDict({
        type: _interactiveAuth.AuthType.Recaptcha,
        response: response
      });
    });
  }

  componentDidMount() {
    this.props.onPhaseChange(DEFAULT_PHASE);
  }

  render() {
    if (this.props.busy) {
      return /*#__PURE__*/_react.default.createElement(_Spinner.default, null);
    }

    let errorText = this.props.errorText;
    let sitePublicKey;

    if (!this.props.stageParams || !this.props.stageParams.public_key) {
      errorText = (0, _languageHandler._t)("Missing captcha public key in homeserver configuration. Please report " + "this to your homeserver administrator.");
    } else {
      sitePublicKey = this.props.stageParams.public_key;
    }

    let errorSection;

    if (errorText) {
      errorSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "error",
        role: "alert"
      }, errorText);
    }

    return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement(_CaptchaForm.default, {
      sitePublicKey: sitePublicKey,
      onCaptchaResponse: this.onCaptchaResponse
    }), errorSection);
  }

}, (0, _defineProperty2.default)(_class4, "LOGIN_TYPE", _interactiveAuth.AuthType.Recaptcha), _temp2)) || _class3);
exports.RecaptchaAuthEntry = RecaptchaAuthEntry;
let TermsAuthEntry = (_dec3 = (0, _replaceableComponent.replaceableComponent)("views.auth.TermsAuthEntry"), _dec3(_class5 = (_temp3 = _class6 = class TermsAuthEntry extends _react.default.Component {
  constructor(props) {
    super(props); // example stageParams:
    //
    // {
    //     "policies": {
    //         "privacy_policy": {
    //             "version": "1.0",
    //             "en": {
    //                 "name": "Privacy Policy",
    //                 "url": "https://example.org/privacy-1.0-en.html",
    //             },
    //             "fr": {
    //                 "name": "Politique de confidentialitÃ©",
    //                 "url": "https://example.org/privacy-1.0-fr.html",
    //             },
    //         },
    //         "other_policy": { ... },
    //     }
    // }

    (0, _defineProperty2.default)(this, "tryContinue", () => {
      this.trySubmit();
    });
    (0, _defineProperty2.default)(this, "trySubmit", () => {
      let allChecked = true;

      for (const policy of this.state.policies) {
        const checked = this.state.toggledPolicies[policy.id];
        allChecked = allChecked && checked;
      }

      if (allChecked) {
        this.props.submitAuthDict({
          type: _interactiveAuth.AuthType.Terms
        });

        _CountlyAnalytics.default.instance.track("onboarding_terms_complete");
      } else {
        this.setState({
          errorText: (0, _languageHandler._t)("Please review and accept all of the homeserver's policies")
        });
      }
    });
    const allPolicies = this.props.stageParams.policies || {};

    const prefLang = _SettingsStore.default.getValue("language");

    const initToggles = {};
    const pickedPolicies = [];

    for (const policyId of Object.keys(allPolicies)) {
      const policy = allPolicies[policyId]; // Pick a language based on the user's language, falling back to english,
      // and finally to the first language available. If there's still no policy
      // available then the homeserver isn't respecting the spec.

      let langPolicy = policy[prefLang];
      if (!langPolicy) langPolicy = policy["en"];

      if (!langPolicy) {
        // last resort
        const firstLang = Object.keys(policy).find(e => e !== "version");
        langPolicy = policy[firstLang];
      }

      if (!langPolicy) throw new Error("Failed to find a policy to show the user");
      initToggles[policyId] = false;
      pickedPolicies.push({
        id: policyId,
        name: langPolicy.name,
        url: langPolicy.url
      });
    }

    this.state = {
      toggledPolicies: initToggles,
      policies: pickedPolicies
    };

    _CountlyAnalytics.default.instance.track("onboarding_terms_begin");
  }

  componentDidMount() {
    this.props.onPhaseChange(DEFAULT_PHASE);
  }

  togglePolicy(policyId) {
    const newToggles = {};

    for (const policy of this.state.policies) {
      let checked = this.state.toggledPolicies[policy.id];
      if (policy.id === policyId) checked = !checked;
      newToggles[policy.id] = checked;
    }

    this.setState({
      "toggledPolicies": newToggles
    });
  }

  render() {
    if (this.props.busy) {
      return /*#__PURE__*/_react.default.createElement(_Spinner.default, null);
    }

    const checkboxes = [];
    let allChecked = true;

    for (const policy of this.state.policies) {
      const checked = this.state.toggledPolicies[policy.id];
      allChecked = allChecked && checked;
      checkboxes.push(
      /*#__PURE__*/
      // XXX: replace with StyledCheckbox
      _react.default.createElement("label", {
        key: "policy_checkbox_" + policy.id,
        className: "mx_InteractiveAuthEntryComponents_termsPolicy"
      }, /*#__PURE__*/_react.default.createElement("input", {
        type: "checkbox",
        onChange: () => this.togglePolicy(policy.id),
        checked: checked
      }), /*#__PURE__*/_react.default.createElement("a", {
        href: policy.url,
        target: "_blank",
        rel: "noreferrer noopener"
      }, policy.name)));
    }

    let errorSection;

    if (this.props.errorText || this.state.errorText) {
      errorSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "error",
        role: "alert"
      }, this.props.errorText || this.state.errorText);
    }

    let submitButton;

    if (this.props.showContinue !== false) {
      // XXX: button classes
      submitButton = /*#__PURE__*/_react.default.createElement("button", {
        className: "mx_InteractiveAuthEntryComponents_termsSubmit mx_GeneralButton",
        onClick: this.trySubmit,
        disabled: !allChecked
      }, (0, _languageHandler._t)("Accept"));
    }

    return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Please review and accept the policies of this homeserver:")), checkboxes, errorSection, submitButton);
  }

}, (0, _defineProperty2.default)(_class6, "LOGIN_TYPE", _interactiveAuth.AuthType.Terms), _temp3)) || _class5);
exports.TermsAuthEntry = TermsAuthEntry;
let EmailIdentityAuthEntry = (_dec4 = (0, _replaceableComponent.replaceableComponent)("views.auth.EmailIdentityAuthEntry"), _dec4(_class7 = (_temp4 = _class8 = class EmailIdentityAuthEntry extends _react.default.Component {
  componentDidMount() {
    this.props.onPhaseChange(DEFAULT_PHASE);
  }

  render() {
    var _this$props$stageStat;

    let errorSection; // ignore the error when errcode is M_UNAUTHORIZED as we expect that error until the link is clicked.

    if (this.props.errorText && this.props.errorCode !== "M_UNAUTHORIZED") {
      errorSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "error",
        role: "alert"
      }, this.props.errorText);
    } // This component is now only displayed once the token has been requested,
    // so we know the email has been sent. It can also get loaded after the user
    // has clicked the validation link if the server takes a while to propagate
    // the validation internally. If we're in the session spawned from clicking
    // the validation link, we won't know the email address, so if we don't have it,
    // assume that the link has been clicked and the server will realise when we poll.
    // We only have a session ID if the user has clicked the link in their email,
    // so show a loading state instead of "an email has been sent to..." because
    // that's confusing when you've already read that email.


    if (this.props.inputs.emailAddress === undefined || (_this$props$stageStat = this.props.stageState) !== null && _this$props$stageStat !== void 0 && _this$props$stageStat.emailSid) {
      if (errorSection) {
        return errorSection;
      }

      return /*#__PURE__*/_react.default.createElement(_Spinner.default, null);
    } else {
      return /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_InteractiveAuthEntryComponents_emailWrapper"
      }, /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("A confirmation email has been sent to %(emailAddress)s", {
        emailAddress: /*#__PURE__*/_react.default.createElement("b", null, this.props.inputs.emailAddress)
      })), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Open the link in the email to continue registration.")), errorSection);
    }
  }

}, (0, _defineProperty2.default)(_class8, "LOGIN_TYPE", _interactiveAuth.AuthType.Email), _temp4)) || _class7);
exports.EmailIdentityAuthEntry = EmailIdentityAuthEntry;
let MsisdnAuthEntry = (_dec5 = (0, _replaceableComponent.replaceableComponent)("views.auth.MsisdnAuthEntry"), _dec5(_class9 = (_temp5 = _class10 = class MsisdnAuthEntry extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "submitUrl", void 0);
    (0, _defineProperty2.default)(this, "sid", void 0);
    (0, _defineProperty2.default)(this, "msisdn", void 0);
    (0, _defineProperty2.default)(this, "onTokenChange", e => {
      this.setState({
        token: e.target.value
      });
    });
    (0, _defineProperty2.default)(this, "onFormSubmit", async e => {
      e.preventDefault();
      if (this.state.token == '') return;
      this.setState({
        errorText: null
      });

      try {
        let result;

        if (this.submitUrl) {
          result = await this.props.matrixClient.submitMsisdnTokenOtherUrl(this.submitUrl, this.sid, this.props.clientSecret, this.state.token);
        } else {
          throw new Error("The registration with MSISDN flow is misconfigured");
        }

        if (result.success) {
          const creds = {
            sid: this.sid,
            client_secret: this.props.clientSecret
          };
          this.props.submitAuthDict({
            type: _interactiveAuth.AuthType.Msisdn,
            // TODO: Remove `threepid_creds` once servers support proper UIA
            // See https://github.com/vector-im/element-web/issues/10312
            // See https://github.com/matrix-org/matrix-doc/issues/2220
            threepid_creds: creds,
            threepidCreds: creds
          });
        } else {
          this.setState({
            errorText: (0, _languageHandler._t)("Token incorrect")
          });
        }
      } catch (e) {
        this.props.fail(e);

        _logger.logger.log("Failed to submit msisdn token");
      }
    });
    this.state = {
      token: '',
      requestingToken: false,
      errorText: ''
    };
  }

  componentDidMount() {
    this.props.onPhaseChange(DEFAULT_PHASE);
    this.setState({
      requestingToken: true
    });
    this.requestMsisdnToken().catch(e => {
      this.props.fail(e);
    }).finally(() => {
      this.setState({
        requestingToken: false
      });
    });
  }
  /*
   * Requests a verification token by SMS.
   */


  requestMsisdnToken() {
    return this.props.matrixClient.requestRegisterMsisdnToken(this.props.inputs.phoneCountry, this.props.inputs.phoneNumber, this.props.clientSecret, 1 // TODO: Multiple send attempts?
    ).then(result => {
      this.submitUrl = result.submit_url;
      this.sid = result.sid;
      this.msisdn = result.msisdn;
    });
  }

  render() {
    if (this.state.requestingToken) {
      return /*#__PURE__*/_react.default.createElement(_Spinner.default, null);
    } else {
      const enableSubmit = Boolean(this.state.token);
      const submitClasses = (0, _classnames.default)({
        mx_InteractiveAuthEntryComponents_msisdnSubmit: true,
        mx_GeneralButton: true
      });
      let errorSection;

      if (this.state.errorText) {
        errorSection = /*#__PURE__*/_react.default.createElement("div", {
          className: "error",
          role: "alert"
        }, this.state.errorText);
      }

      return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("A text message has been sent to %(msisdn)s", {
        msisdn: /*#__PURE__*/_react.default.createElement("i", null, this.msisdn)
      })), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Please enter the code it contains:")), /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_InteractiveAuthEntryComponents_msisdnWrapper"
      }, /*#__PURE__*/_react.default.createElement("form", {
        onSubmit: this.onFormSubmit
      }, /*#__PURE__*/_react.default.createElement("input", {
        type: "text",
        className: "mx_InteractiveAuthEntryComponents_msisdnEntry",
        value: this.state.token,
        onChange: this.onTokenChange,
        "aria-label": (0, _languageHandler._t)("Code")
      }), /*#__PURE__*/_react.default.createElement("br", null), /*#__PURE__*/_react.default.createElement("input", {
        type: "submit",
        value: (0, _languageHandler._t)("Submit"),
        className: submitClasses,
        disabled: !enableSubmit
      })), errorSection));
    }
  }

}, (0, _defineProperty2.default)(_class10, "LOGIN_TYPE", _interactiveAuth.AuthType.Msisdn), _temp5)) || _class9);
exports.MsisdnAuthEntry = MsisdnAuthEntry;
let SSOAuthEntry = (_dec6 = (0, _replaceableComponent.replaceableComponent)("views.auth.SSOAuthEntry"), _dec6(_class11 = (_temp6 = _class12 = class SSOAuthEntry extends _react.default.Component {
  // button to start SSO
  // button to confirm SSO completed
  constructor(props) {
    super(props); // We actually send the user through fallback auth so we don't have to
    // deal with a redirect back to us, losing application context.

    (0, _defineProperty2.default)(this, "ssoUrl", void 0);
    (0, _defineProperty2.default)(this, "popupWindow", void 0);
    (0, _defineProperty2.default)(this, "attemptFailed", () => {
      this.setState({
        attemptFailed: true
      });
    });
    (0, _defineProperty2.default)(this, "onReceiveMessage", event => {
      if (event.data === "authDone" && event.origin === this.props.matrixClient.getHomeserverUrl()) {
        if (this.popupWindow) {
          this.popupWindow.close();
          this.popupWindow = null;
        }
      }
    });
    (0, _defineProperty2.default)(this, "onStartAuthClick", () => {
      // Note: We don't use PlatformPeg's startSsoAuth functions because we almost
      // certainly will need to open the thing in a new tab to avoid losing application
      // context.
      this.popupWindow = window.open(this.ssoUrl, "_blank");
      this.setState({
        phase: SSOAuthEntry.PHASE_POSTAUTH
      });
      this.props.onPhaseChange(SSOAuthEntry.PHASE_POSTAUTH);
    });
    (0, _defineProperty2.default)(this, "onConfirmClick", () => {
      this.props.submitAuthDict({});
    });
    this.ssoUrl = props.matrixClient.getFallbackAuthUrl(this.props.loginType, this.props.authSessionId);
    this.popupWindow = null;
    window.addEventListener("message", this.onReceiveMessage);
    this.state = {
      phase: SSOAuthEntry.PHASE_PREAUTH,
      attemptFailed: false
    };
  }

  componentDidMount() {
    this.props.onPhaseChange(SSOAuthEntry.PHASE_PREAUTH);
  }

  componentWillUnmount() {
    window.removeEventListener("message", this.onReceiveMessage);

    if (this.popupWindow) {
      this.popupWindow.close();
      this.popupWindow = null;
    }
  }

  render() {
    let continueButton = null;

    const cancelButton = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      onClick: this.props.onCancel,
      kind: this.props.continueKind ? this.props.continueKind + '_outline' : 'primary_outline'
    }, (0, _languageHandler._t)("Cancel"));

    if (this.state.phase === SSOAuthEntry.PHASE_PREAUTH) {
      continueButton = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        onClick: this.onStartAuthClick,
        kind: this.props.continueKind || 'primary'
      }, this.props.continueText || (0, _languageHandler._t)("Single Sign On"));
    } else {
      continueButton = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        onClick: this.onConfirmClick,
        kind: this.props.continueKind || 'primary'
      }, this.props.continueText || (0, _languageHandler._t)("Confirm"));
    }

    let errorSection;

    if (this.props.errorText) {
      errorSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "error",
        role: "alert"
      }, this.props.errorText);
    } else if (this.state.attemptFailed) {
      errorSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "error",
        role: "alert"
      }, (0, _languageHandler._t)("Something went wrong in confirming your identity. Cancel and try again."));
    }

    return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, errorSection, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InteractiveAuthEntryComponents_sso_buttons"
    }, cancelButton, continueButton));
  }

}, (0, _defineProperty2.default)(_class12, "LOGIN_TYPE", _interactiveAuth.AuthType.Sso), (0, _defineProperty2.default)(_class12, "UNSTABLE_LOGIN_TYPE", _interactiveAuth.AuthType.SsoUnstable), (0, _defineProperty2.default)(_class12, "PHASE_PREAUTH", 1), (0, _defineProperty2.default)(_class12, "PHASE_POSTAUTH", 2), _temp6)) || _class11);
exports.SSOAuthEntry = SSOAuthEntry;
let FallbackAuthEntry = (_dec7 = (0, _replaceableComponent.replaceableComponent)("views.auth.FallbackAuthEntry"), _dec7(_class13 = class FallbackAuthEntry extends _react.default.Component {
  constructor(props) {
    super(props); // we have to make the user click a button, as browsers will block
    // the popup if we open it immediately.

    (0, _defineProperty2.default)(this, "popupWindow", void 0);
    (0, _defineProperty2.default)(this, "fallbackButton", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "focus", () => {
      if (this.fallbackButton.current) {
        this.fallbackButton.current.focus();
      }
    });
    (0, _defineProperty2.default)(this, "onShowFallbackClick", e => {
      e.preventDefault();
      e.stopPropagation();
      const url = this.props.matrixClient.getFallbackAuthUrl(this.props.loginType, this.props.authSessionId);
      this.popupWindow = window.open(url, "_blank");
    });
    (0, _defineProperty2.default)(this, "onReceiveMessage", event => {
      if (event.data === "authDone" && event.origin === this.props.matrixClient.getHomeserverUrl()) {
        this.props.submitAuthDict({});
      }
    });
    this.popupWindow = null;
    window.addEventListener("message", this.onReceiveMessage);
  }

  componentDidMount() {
    this.props.onPhaseChange(DEFAULT_PHASE);
  }

  componentWillUnmount() {
    window.removeEventListener("message", this.onReceiveMessage);

    if (this.popupWindow) {
      this.popupWindow.close();
    }
  }

  render() {
    let errorSection;

    if (this.props.errorText) {
      errorSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "error",
        role: "alert"
      }, this.props.errorText);
    }

    return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement("a", {
      href: "",
      ref: this.fallbackButton,
      onClick: this.onShowFallbackClick
    }, (0, _languageHandler._t)("Start authentication")), errorSection);
  }

}) || _class13);
exports.FallbackAuthEntry = FallbackAuthEntry;

function getEntryComponentForLoginType(loginType) {
  switch (loginType) {
    case _interactiveAuth.AuthType.Password:
      return PasswordAuthEntry;

    case _interactiveAuth.AuthType.Recaptcha:
      return RecaptchaAuthEntry;

    case _interactiveAuth.AuthType.Email:
      return EmailIdentityAuthEntry;

    case _interactiveAuth.AuthType.Msisdn:
      return MsisdnAuthEntry;

    case _interactiveAuth.AuthType.Terms:
      return TermsAuthEntry;

    case _interactiveAuth.AuthType.Sso:
    case _interactiveAuth.AuthType.SsoUnstable:
      return SSOAuthEntry;

    default:
      return FallbackAuthEntry;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2F1dGgvSW50ZXJhY3RpdmVBdXRoRW50cnlDb21wb25lbnRzLnRzeCJdLCJuYW1lcyI6WyJERUZBVUxUX1BIQVNFIiwiUGFzc3dvcmRBdXRoRW50cnkiLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJlIiwicHJldmVudERlZmF1bHQiLCJidXN5Iiwic3VibWl0QXV0aERpY3QiLCJ0eXBlIiwiQXV0aFR5cGUiLCJQYXNzd29yZCIsInVzZXIiLCJtYXRyaXhDbGllbnQiLCJjcmVkZW50aWFscyIsInVzZXJJZCIsImlkZW50aWZpZXIiLCJwYXNzd29yZCIsInN0YXRlIiwiZXYiLCJzZXRTdGF0ZSIsInRhcmdldCIsInZhbHVlIiwiY29tcG9uZW50RGlkTW91bnQiLCJvblBoYXNlQ2hhbmdlIiwicmVuZGVyIiwicGFzc3dvcmRCb3hDbGFzcyIsImVycm9yVGV4dCIsInN1Ym1pdEJ1dHRvbk9yU3Bpbm5lciIsImVycm9yU2VjdGlvbiIsIm9uU3VibWl0Iiwib25QYXNzd29yZEZpZWxkQ2hhbmdlIiwiUmVjYXB0Y2hhQXV0aEVudHJ5IiwicmVzcG9uc2UiLCJDb3VudGx5QW5hbHl0aWNzIiwiaW5zdGFuY2UiLCJ0cmFjayIsIlJlY2FwdGNoYSIsInNpdGVQdWJsaWNLZXkiLCJzdGFnZVBhcmFtcyIsInB1YmxpY19rZXkiLCJvbkNhcHRjaGFSZXNwb25zZSIsIlRlcm1zQXV0aEVudHJ5IiwidHJ5U3VibWl0IiwiYWxsQ2hlY2tlZCIsInBvbGljeSIsInBvbGljaWVzIiwiY2hlY2tlZCIsInRvZ2dsZWRQb2xpY2llcyIsImlkIiwiVGVybXMiLCJhbGxQb2xpY2llcyIsInByZWZMYW5nIiwiU2V0dGluZ3NTdG9yZSIsImdldFZhbHVlIiwiaW5pdFRvZ2dsZXMiLCJwaWNrZWRQb2xpY2llcyIsInBvbGljeUlkIiwiT2JqZWN0Iiwia2V5cyIsImxhbmdQb2xpY3kiLCJmaXJzdExhbmciLCJmaW5kIiwiRXJyb3IiLCJwdXNoIiwibmFtZSIsInVybCIsInRvZ2dsZVBvbGljeSIsIm5ld1RvZ2dsZXMiLCJjaGVja2JveGVzIiwic3VibWl0QnV0dG9uIiwic2hvd0NvbnRpbnVlIiwiRW1haWxJZGVudGl0eUF1dGhFbnRyeSIsImVycm9yQ29kZSIsImlucHV0cyIsImVtYWlsQWRkcmVzcyIsInVuZGVmaW5lZCIsInN0YWdlU3RhdGUiLCJlbWFpbFNpZCIsIkVtYWlsIiwiTXNpc2RuQXV0aEVudHJ5IiwidG9rZW4iLCJyZXN1bHQiLCJzdWJtaXRVcmwiLCJzdWJtaXRNc2lzZG5Ub2tlbk90aGVyVXJsIiwic2lkIiwiY2xpZW50U2VjcmV0Iiwic3VjY2VzcyIsImNyZWRzIiwiY2xpZW50X3NlY3JldCIsIk1zaXNkbiIsInRocmVlcGlkX2NyZWRzIiwidGhyZWVwaWRDcmVkcyIsImZhaWwiLCJsb2dnZXIiLCJsb2ciLCJyZXF1ZXN0aW5nVG9rZW4iLCJyZXF1ZXN0TXNpc2RuVG9rZW4iLCJjYXRjaCIsImZpbmFsbHkiLCJyZXF1ZXN0UmVnaXN0ZXJNc2lzZG5Ub2tlbiIsInBob25lQ291bnRyeSIsInBob25lTnVtYmVyIiwidGhlbiIsInN1Ym1pdF91cmwiLCJtc2lzZG4iLCJlbmFibGVTdWJtaXQiLCJCb29sZWFuIiwic3VibWl0Q2xhc3NlcyIsIm14X0ludGVyYWN0aXZlQXV0aEVudHJ5Q29tcG9uZW50c19tc2lzZG5TdWJtaXQiLCJteF9HZW5lcmFsQnV0dG9uIiwib25Gb3JtU3VibWl0Iiwib25Ub2tlbkNoYW5nZSIsIlNTT0F1dGhFbnRyeSIsImF0dGVtcHRGYWlsZWQiLCJldmVudCIsImRhdGEiLCJvcmlnaW4iLCJnZXRIb21lc2VydmVyVXJsIiwicG9wdXBXaW5kb3ciLCJjbG9zZSIsIndpbmRvdyIsIm9wZW4iLCJzc29VcmwiLCJwaGFzZSIsIlBIQVNFX1BPU1RBVVRIIiwiZ2V0RmFsbGJhY2tBdXRoVXJsIiwibG9naW5UeXBlIiwiYXV0aFNlc3Npb25JZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvblJlY2VpdmVNZXNzYWdlIiwiUEhBU0VfUFJFQVVUSCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNvbnRpbnVlQnV0dG9uIiwiY2FuY2VsQnV0dG9uIiwib25DYW5jZWwiLCJjb250aW51ZUtpbmQiLCJvblN0YXJ0QXV0aENsaWNrIiwiY29udGludWVUZXh0Iiwib25Db25maXJtQ2xpY2siLCJTc28iLCJTc29VbnN0YWJsZSIsIkZhbGxiYWNrQXV0aEVudHJ5IiwiZmFsbGJhY2tCdXR0b24iLCJjdXJyZW50IiwiZm9jdXMiLCJzdG9wUHJvcGFnYXRpb24iLCJvblNob3dGYWxsYmFja0NsaWNrIiwiZ2V0RW50cnlDb21wb25lbnRGb3JMb2dpblR5cGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQWdCQTs7QUFDQTs7QUFFQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFFQTs7Ozs7Ozs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFTyxNQUFNQSxhQUFhLEdBQUcsQ0FBdEI7O0lBbUJNQyxpQixXQURaLGdEQUFxQiw4QkFBckIsQyxtQ0FBRCxNQUNhQSxpQkFEYixTQUN1Q0MsZUFBTUMsU0FEN0MsQ0FDaUc7QUFHN0ZDLEVBQUFBLFdBQVcsQ0FBQ0MsS0FBRCxFQUFRO0FBQ2YsVUFBTUEsS0FBTjtBQURlLG9EQVlDQyxDQUFELElBQWtCO0FBQ2pDQSxNQUFBQSxDQUFDLENBQUNDLGNBQUY7QUFDQSxVQUFJLEtBQUtGLEtBQUwsQ0FB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LEtBQWQ7QUFDSSxhQUFPUixjQUFQOztBQUNKLFNBQUtoQywwQkFBU21JLEdBQWQ7QUFDQSxTQUFLbkksMEJBQVNvSSxXQUFkO0FBQ0ksYUFBTzdCLFlBQVA7O0FBQ0o7QUFDSSxhQUFPOEIsaUJBQVA7QUFmUjtBQWlCSCIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxNi0yMDIxIFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFJlYWN0LCB7IENoYW5nZUV2ZW50LCBjcmVhdGVSZWYsIEZvcm1FdmVudCwgTW91c2VFdmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHsgTWF0cml4Q2xpZW50IH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL2NsaWVudFwiO1xuaW1wb3J0IHsgQXV0aFR5cGUsIElBdXRoRGljdCwgSUlucHV0cywgSVN0YWdlU3RhdHVzIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvaW50ZXJhY3RpdmUtYXV0aCc7XG5cbmltcG9ydCB7IF90IH0gZnJvbSAnLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyJztcbmltcG9ydCBTZXR0aW5nc1N0b3JlIGZyb20gXCIuLi8uLi8uLi9zZXR0aW5ncy9TZXR0aW5nc1N0b3JlXCI7XG5pbXBvcnQgQWNjZXNzaWJsZUJ1dHRvbiBmcm9tIFwiLi4vZWxlbWVudHMvQWNjZXNzaWJsZUJ1dHRvblwiO1xuaW1wb3J0IFNwaW5uZXIgZnJvbSBcIi4uL2VsZW1lbnRzL1NwaW5uZXJcIjtcbmltcG9ydCBDb3VudGx5QW5hbHl0aWNzIGZyb20gXCIuLi8uLi8uLi9Db3VudGx5QW5hbHl0aWNzXCI7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuaW1wb3J0IHsgTG9jYWxpc2VkUG9saWN5LCBQb2xpY2llcyB9IGZyb20gJy4uLy4uLy4uL1Rlcm1zJztcbmltcG9ydCBGaWVsZCBmcm9tICcuLi9lbGVtZW50cy9GaWVsZCc7XG5pbXBvcnQgQ2FwdGNoYUZvcm0gZnJvbSBcIi4vQ2FwdGNoYUZvcm1cIjtcblxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL2xvZ2dlclwiO1xuXG4vKiBUaGlzIGZpbGUgY29udGFpbnMgYSBjb2xsZWN0aW9uIG9mIGNvbXBvbmVudHMgd2hpY2ggYXJlIHVzZWQgYnkgdGhlXG4gKiBJbnRlcmFjdGl2ZUF1dGggdG8gcHJvbXB0IHRoZSB1c2VyIHRvIGVudGVyIHRoZSBpbmZvcm1hdGlvbiBuZWVkZWRcbiAqIGZvciBhbiBhdXRoIHN0YWdlLiAoVGhlIGludGVudGlvbiBpcyB0aGF0IHRoZXkgY291bGQgYWxzbyBiZSB1c2VkIGZvciBvdGhlclxuICogY29tcG9uZW50cywgc3VjaCBhcyB0aGUgcmVnaXN0cmF0aW9uIGZsb3cpLlxuICpcbiAqIENhbGwgZ2V0RW50cnlDb21wb25lbnRGb3JMb2dpblR5cGUoKSB0byBnZXQgYSBjb21wb25lbnQgc3VpdGFibGUgZm9yIGFcbiAqIHBhcnRpY3VsYXIgbG9naW4gdHlwZS4gRWFjaCBjb21wb25lbnQgcmVxdWlyZXMgdGhlIHNhbWUgcHJvcGVydGllczpcbiAqXG4gKiBtYXRyaXhDbGllbnQ6ICAgICAgICAgICBBIG1hdHJpeCBjbGllbnQuIE1heSBiZSBhIGRpZmZlcmVudCBvbmUgdG8gdGhlIG9uZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudGx5IGJlaW5nIHVzZWQgZ2VuZXJhbGx5IChlZy4gdG8gcmVnaXN0ZXIgd2l0aFxuICogICAgICAgICAgICAgICAgICAgICAgICAgb25lIEhTIHdoaWxzdCBiZWluZyBhIGd1ZXN0IG9uIGFub3RoZXIpLlxuICogbG9naW5UeXBlOiAgICAgICAgICAgICAgdGhlIGxvZ2luIHR5cGUgb2YgdGhlIGF1dGggc3RhZ2UgYmVpbmcgYXR0ZW1wdGVkXG4gKiBhdXRoU2Vzc2lvbklkOiAgICAgICAgICBzZXNzaW9uIGlkIGZyb20gdGhlIHNlcnZlclxuICogY2xpZW50U2VjcmV0OiAgICAgICAgICAgVGhlIGNsaWVudCBzZWNyZXQgaW4gdXNlIGZvciBpZGVudGl0eSBzZXJ2ZXIgYXV0aCBzZXNzaW9uc1xuICogc3RhZ2VQYXJhbXM6ICAgICAgICAgICAgcGFyYW1zIGZyb20gdGhlIHNlcnZlciBmb3IgdGhlIHN0YWdlIGJlaW5nIGF0dGVtcHRlZFxuICogZXJyb3JUZXh0OiAgICAgICAgICAgICAgZXJyb3IgbWVzc2FnZSBmcm9tIGEgcHJldmlvdXMgYXR0ZW1wdCB0byBhdXRoZW50aWNhdGVcbiAqIHN1Ym1pdEF1dGhEaWN0OiAgICAgICAgIGEgZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgbmV3IGF1dGggZGljdFxuICogYnVzeTogICAgICAgICAgICAgICAgICAgYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgYXV0aCBsb2dpYyBpcyBkb2luZyBzb21ldGhpbmdcbiAqICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSB1c2VyIG5lZWRzIHRvIHdhaXQgZm9yLlxuICogaW5wdXRzOiAgICAgICAgICAgICAgICAgT2JqZWN0IG9mIGlucHV0cyBwcm92aWRlZCBieSB0aGUgdXNlciwgYXMgaW4ganMtc2RrXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGl2ZS1hdXRoXG4gKiBzdGFnZVN0YXRlOiAgICAgICAgICAgICBTdGFnZS1zcGVjaWZpYyBvYmplY3QgdXNlZCBmb3IgY29tbXVuaWNhdGluZyBzdGF0ZSBpbmZvcm1hdGlvblxuICogICAgICAgICAgICAgICAgICAgICAgICAgdG8gdGhlIFVJIGZyb20gdGhlIHN0YXRlLXNwZWNpZmljIGF1dGggbG9naWMuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICBEZWZpbmVkIGtleXMgZm9yIHN0YWdlcyBhcmU6XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5sb2dpbi5lbWFpbC5pZGVudGl0eTpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBlbWFpbFNpZDogc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgc2lkIG9mIHRoZSBhY3RpdmVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyaWZpY2F0aW9uIHNlc3Npb24gZnJvbSB0aGUgaWRlbnRpdHkgc2VydmVyLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciBudWxsIGlmIG5vIHNlc3Npb24gaXMgYWN0aXZlLlxuICogZmFpbDogICAgICAgICAgICAgICAgICAgYSBmdW5jdGlvbiB3aGljaCBzaG91bGQgYmUgY2FsbGVkIHdpdGggYW4gZXJyb3Igb2JqZWN0IGlmIGFuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciBvY2N1cnJlZCBkdXJpbmcgdGhlIGF1dGggc3RhZ2UuIFRoaXMgd2lsbCBjYXVzZSB0aGUgYXV0aFxuICogICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbiB0byBiZSBmYWlsZWQgYW5kIHRoZSBwcm9jZXNzIHRvIGdvIGJhY2sgdG8gdGhlIHN0YXJ0LlxuICogc2V0RW1haWxTaWQ6ICAgICAgICAgICAgbS5sb2dpbi5lbWFpbC5pZGVudGl0eSBvbmx5OiBhIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aXRoIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgZW1haWwgc2lkIGFmdGVyIGEgdG9rZW4gaXMgcmVxdWVzdGVkLlxuICogb25QaGFzZUNoYW5nZTogICAgICAgICAgQSBmdW5jdGlvbiB3aGljaCBpcyBjYWxsZWQgd2hlbiB0aGUgc3RhZ2UncyBwaGFzZSBjaGFuZ2VzLiBJZlxuICogICAgICAgICAgICAgICAgICAgICAgICAgdGhlIHN0YWdlIGhhcyBubyBwaGFzZXMsIGNhbGwgdGhpcyB3aXRoIERFRkFVTFRfUEhBU0UuIFRha2VzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICBvbmUgYXJndW1lbnQsIHRoZSBwaGFzZSwgYW5kIGlzIGFsd2F5cyBkZWZpbmVkL3JlcXVpcmVkLlxuICogY29udGludWVUZXh0OiAgICAgICAgICAgRm9yIHN0YWdlcyB3aGljaCBoYXZlIGEgY29udGludWUgYnV0dG9uLCB0aGUgdGV4dCB0byB1c2UuXG4gKiBjb250aW51ZUtpbmQ6ICAgICAgICAgICBGb3Igc3RhZ2VzIHdoaWNoIGhhdmUgYSBjb250aW51ZSBidXR0b24sIHRoZSBzdHlsZSBvZiBidXR0b24gdG9cbiAqICAgICAgICAgICAgICAgICAgICAgICAgIHVzZS4gRm9yIGV4YW1wbGUsICdkYW5nZXInIG9yICdwcmltYXJ5Jy5cbiAqIG9uQ2FuY2VsICAgICAgICAgICAgICAgIEEgZnVuY3Rpb24gd2l0aCBubyBhcmd1bWVudHMgd2hpY2ggaXMgY2FsbGVkIGJ5IHRoZSBzdGFnZSBpZiB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIga25vd2luZ2x5IGNhbmNlbGxlZC9kaXNtaXNzZWQgdGhlIGF1dGhlbnRpY2F0aW9uIGF0dGVtcHQuXG4gKlxuICogRWFjaCBjb21wb25lbnQgbWF5IGFsc28gcHJvdmlkZSB0aGUgZm9sbG93aW5nIGZ1bmN0aW9ucyAoYmV5b25kIHRoZSBzdGFuZGFyZCBSZWFjdCBvbmVzKTpcbiAqICAgIGZvY3VzOiBzZXQgdGhlIGlucHV0IGZvY3VzIGFwcHJvcHJpYXRlbHkgaW4gdGhlIGZvcm0uXG4gKi9cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUEhBU0UgPSAwO1xuXG5pbnRlcmZhY2UgSUF1dGhFbnRyeVByb3BzIHtcbiAgICBtYXRyaXhDbGllbnQ6IE1hdHJpeENsaWVudDtcbiAgICBsb2dpblR5cGU6IHN0cmluZztcbiAgICBhdXRoU2Vzc2lvbklkOiBzdHJpbmc7XG4gICAgZXJyb3JUZXh0Pzogc3RyaW5nO1xuICAgIGVycm9yQ29kZT86IHN0cmluZztcbiAgICAvLyBJcyB0aGUgYXV0aCBsb2dpYyBjdXJyZW50bHkgd2FpdGluZyBmb3Igc29tZXRoaW5nIHRvIGhhcHBlbj9cbiAgICBidXN5PzogYm9vbGVhbjtcbiAgICBvblBoYXNlQ2hhbmdlOiAocGhhc2U6IG51bWJlcikgPT4gdm9pZDtcbiAgICBzdWJtaXRBdXRoRGljdDogKGF1dGg6IElBdXRoRGljdCkgPT4gdm9pZDtcbn1cblxuaW50ZXJmYWNlIElQYXNzd29yZEF1dGhFbnRyeVN0YXRlIHtcbiAgICBwYXNzd29yZDogc3RyaW5nO1xufVxuXG5AcmVwbGFjZWFibGVDb21wb25lbnQoXCJ2aWV3cy5hdXRoLlBhc3N3b3JkQXV0aEVudHJ5XCIpXG5leHBvcnQgY2xhc3MgUGFzc3dvcmRBdXRoRW50cnkgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SUF1dGhFbnRyeVByb3BzLCBJUGFzc3dvcmRBdXRoRW50cnlTdGF0ZT4ge1xuICAgIHN0YXRpYyBMT0dJTl9UWVBFID0gQXV0aFR5cGUuUGFzc3dvcmQ7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHBhc3N3b3JkOiBcIlwiLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLnByb3BzLm9uUGhhc2VDaGFuZ2UoREVGQVVMVF9QSEFTRSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblN1Ym1pdCA9IChlOiBGb3JtRXZlbnQpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5idXN5KSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5wcm9wcy5zdWJtaXRBdXRoRGljdCh7XG4gICAgICAgICAgICB0eXBlOiBBdXRoVHlwZS5QYXNzd29yZCxcbiAgICAgICAgICAgIC8vIFRPRE86IFJlbW92ZSBgdXNlcmAgb25jZSBzZXJ2ZXJzIHN1cHBvcnQgcHJvcGVyIFVJQVxuICAgICAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZWN0b3ItaW0vZWxlbWVudC13ZWIvaXNzdWVzLzEwMzEyXG4gICAgICAgICAgICB1c2VyOiB0aGlzLnByb3BzLm1hdHJpeENsaWVudC5jcmVkZW50aWFscy51c2VySWQsXG4gICAgICAgICAgICBpZGVudGlmaWVyOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJtLmlkLnVzZXJcIixcbiAgICAgICAgICAgICAgICB1c2VyOiB0aGlzLnByb3BzLm1hdHJpeENsaWVudC5jcmVkZW50aWFscy51c2VySWQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuc3RhdGUucGFzc3dvcmQsXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUGFzc3dvcmRGaWVsZENoYW5nZSA9IChldjogQ2hhbmdlRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICAgICAgLy8gZW5hYmxlIHRoZSBzdWJtaXQgYnV0dG9uIGlmZiB0aGUgcGFzc3dvcmQgaXMgbm9uLWVtcHR5XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgcGFzc3dvcmQ6IGV2LnRhcmdldC52YWx1ZSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgcGFzc3dvcmRCb3hDbGFzcyA9IGNsYXNzTmFtZXMoe1xuICAgICAgICAgICAgXCJlcnJvclwiOiB0aGlzLnByb3BzLmVycm9yVGV4dCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IHN1Ym1pdEJ1dHRvbk9yU3Bpbm5lcjtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuYnVzeSkge1xuICAgICAgICAgICAgc3VibWl0QnV0dG9uT3JTcGlubmVyID0gPFNwaW5uZXIgLz47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWJtaXRCdXR0b25PclNwaW5uZXIgPSAoXG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJzdWJtaXRcIlxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9EaWFsb2dfcHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5wYXNzd29yZH1cbiAgICAgICAgICAgICAgICAgICAgdmFsdWU9e190KFwiQ29udGludWVcIil9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZXJyb3JTZWN0aW9uO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5lcnJvclRleHQpIHtcbiAgICAgICAgICAgIGVycm9yU2VjdGlvbiA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImVycm9yXCIgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgICAgICAgICAgIHsgdGhpcy5wcm9wcy5lcnJvclRleHQgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxwPnsgX3QoXCJDb25maXJtIHlvdXIgaWRlbnRpdHkgYnkgZW50ZXJpbmcgeW91ciBhY2NvdW50IHBhc3N3b3JkIGJlbG93LlwiKSB9PC9wPlxuICAgICAgICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXt0aGlzLm9uU3VibWl0fSBjbGFzc05hbWU9XCJteF9JbnRlcmFjdGl2ZUF1dGhFbnRyeUNvbXBvbmVudHNfcGFzc3dvcmRTZWN0aW9uXCI+XG4gICAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtwYXNzd29yZEJveENsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInBhc3N3b3JkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJwYXNzd29yZEZpZWxkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdCgnUGFzc3dvcmQnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9Gb2N1cz17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnBhc3N3b3JkfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25QYXNzd29yZEZpZWxkQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICB7IGVycm9yU2VjdGlvbiB9XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfYnV0dG9uX3Jvd1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBzdWJtaXRCdXR0b25PclNwaW5uZXIgfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSAqL1xuaW50ZXJmYWNlIElSZWNhcHRjaGFBdXRoRW50cnlQcm9wcyBleHRlbmRzIElBdXRoRW50cnlQcm9wcyB7XG4gICAgc3RhZ2VQYXJhbXM/OiB7XG4gICAgICAgIHB1YmxpY19rZXk/OiBzdHJpbmc7XG4gICAgfTtcbn1cbi8qIGVzbGludC1lbmFibGUgY2FtZWxjYXNlICovXG5cbkByZXBsYWNlYWJsZUNvbXBvbmVudChcInZpZXdzLmF1dGguUmVjYXB0Y2hhQXV0aEVudHJ5XCIpXG5leHBvcnQgY2xhc3MgUmVjYXB0Y2hhQXV0aEVudHJ5IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PElSZWNhcHRjaGFBdXRoRW50cnlQcm9wcz4ge1xuICAgIHN0YXRpYyBMT0dJTl9UWVBFID0gQXV0aFR5cGUuUmVjYXB0Y2hhO1xuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25QaGFzZUNoYW5nZShERUZBVUxUX1BIQVNFKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uQ2FwdGNoYVJlc3BvbnNlID0gKHJlc3BvbnNlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgQ291bnRseUFuYWx5dGljcy5pbnN0YW5jZS50cmFjayhcIm9uYm9hcmRpbmdfZ3JlY2FwdGNoYV9zdWJtaXRcIik7XG4gICAgICAgIHRoaXMucHJvcHMuc3VibWl0QXV0aERpY3Qoe1xuICAgICAgICAgICAgdHlwZTogQXV0aFR5cGUuUmVjYXB0Y2hhLFxuICAgICAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5idXN5KSB7XG4gICAgICAgICAgICByZXR1cm4gPFNwaW5uZXIgLz47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZXJyb3JUZXh0ID0gdGhpcy5wcm9wcy5lcnJvclRleHQ7XG5cbiAgICAgICAgbGV0IHNpdGVQdWJsaWNLZXk7XG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5zdGFnZVBhcmFtcyB8fCAhdGhpcy5wcm9wcy5zdGFnZVBhcmFtcy5wdWJsaWNfa2V5KSB7XG4gICAgICAgICAgICBlcnJvclRleHQgPSBfdChcbiAgICAgICAgICAgICAgICBcIk1pc3NpbmcgY2FwdGNoYSBwdWJsaWMga2V5IGluIGhvbWVzZXJ2ZXIgY29uZmlndXJhdGlvbi4gUGxlYXNlIHJlcG9ydCBcIiArXG4gICAgICAgICAgICAgICAgXCJ0aGlzIHRvIHlvdXIgaG9tZXNlcnZlciBhZG1pbmlzdHJhdG9yLlwiLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNpdGVQdWJsaWNLZXkgPSB0aGlzLnByb3BzLnN0YWdlUGFyYW1zLnB1YmxpY19rZXk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZXJyb3JTZWN0aW9uO1xuICAgICAgICBpZiAoZXJyb3JUZXh0KSB7XG4gICAgICAgICAgICBlcnJvclNlY3Rpb24gPSAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJlcnJvclwiIHJvbGU9XCJhbGVydFwiPlxuICAgICAgICAgICAgICAgICAgICB7IGVycm9yVGV4dCB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPENhcHRjaGFGb3JtIHNpdGVQdWJsaWNLZXk9e3NpdGVQdWJsaWNLZXl9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2FwdGNoYVJlc3BvbnNlPXt0aGlzLm9uQ2FwdGNoYVJlc3BvbnNlfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgeyBlcnJvclNlY3Rpb24gfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5pbnRlcmZhY2UgSVRlcm1zQXV0aEVudHJ5UHJvcHMgZXh0ZW5kcyBJQXV0aEVudHJ5UHJvcHMge1xuICAgIHN0YWdlUGFyYW1zPzoge1xuICAgICAgICBwb2xpY2llcz86IFBvbGljaWVzO1xuICAgIH07XG4gICAgc2hvd0NvbnRpbnVlOiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgTG9jYWxpc2VkUG9saWN5V2l0aElkIGV4dGVuZHMgTG9jYWxpc2VkUG9saWN5IHtcbiAgICBpZDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgSVRlcm1zQXV0aEVudHJ5U3RhdGUge1xuICAgIHBvbGljaWVzOiBMb2NhbGlzZWRQb2xpY3lXaXRoSWRbXTtcbiAgICB0b2dnbGVkUG9saWNpZXM6IHtcbiAgICAgICAgW3BvbGljeTogc3RyaW5nXTogYm9vbGVhbjtcbiAgICB9O1xuICAgIGVycm9yVGV4dD86IHN0cmluZztcbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3MuYXV0aC5UZXJtc0F1dGhFbnRyeVwiKVxuZXhwb3J0IGNsYXNzIFRlcm1zQXV0aEVudHJ5IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PElUZXJtc0F1dGhFbnRyeVByb3BzLCBJVGVybXNBdXRoRW50cnlTdGF0ZT4ge1xuICAgIHN0YXRpYyBMT0dJTl9UWVBFID0gQXV0aFR5cGUuVGVybXM7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgLy8gZXhhbXBsZSBzdGFnZVBhcmFtczpcbiAgICAgICAgLy9cbiAgICAgICAgLy8ge1xuICAgICAgICAvLyAgICAgXCJwb2xpY2llc1wiOiB7XG4gICAgICAgIC8vICAgICAgICAgXCJwcml2YWN5X3BvbGljeVwiOiB7XG4gICAgICAgIC8vICAgICAgICAgICAgIFwidmVyc2lvblwiOiBcIjEuMFwiLFxuICAgICAgICAvLyAgICAgICAgICAgICBcImVuXCI6IHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlByaXZhY3kgUG9saWN5XCIsXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBcInVybFwiOiBcImh0dHBzOi8vZXhhbXBsZS5vcmcvcHJpdmFjeS0xLjAtZW4uaHRtbFwiLFxuICAgICAgICAvLyAgICAgICAgICAgICB9LFxuICAgICAgICAvLyAgICAgICAgICAgICBcImZyXCI6IHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlBvbGl0aXF1ZSBkZSBjb25maWRlbnRpYWxpdMOpXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBcInVybFwiOiBcImh0dHBzOi8vZXhhbXBsZS5vcmcvcHJpdmFjeS0xLjAtZnIuaHRtbFwiLFxuICAgICAgICAvLyAgICAgICAgICAgICB9LFxuICAgICAgICAvLyAgICAgICAgIH0sXG4gICAgICAgIC8vICAgICAgICAgXCJvdGhlcl9wb2xpY3lcIjogeyAuLi4gfSxcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfVxuXG4gICAgICAgIGNvbnN0IGFsbFBvbGljaWVzID0gdGhpcy5wcm9wcy5zdGFnZVBhcmFtcy5wb2xpY2llcyB8fCB7fTtcbiAgICAgICAgY29uc3QgcHJlZkxhbmcgPSBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwibGFuZ3VhZ2VcIik7XG4gICAgICAgIGNvbnN0IGluaXRUb2dnbGVzID0ge307XG4gICAgICAgIGNvbnN0IHBpY2tlZFBvbGljaWVzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgcG9saWN5SWQgb2YgT2JqZWN0LmtleXMoYWxsUG9saWNpZXMpKSB7XG4gICAgICAgICAgICBjb25zdCBwb2xpY3kgPSBhbGxQb2xpY2llc1twb2xpY3lJZF07XG5cbiAgICAgICAgICAgIC8vIFBpY2sgYSBsYW5ndWFnZSBiYXNlZCBvbiB0aGUgdXNlcidzIGxhbmd1YWdlLCBmYWxsaW5nIGJhY2sgdG8gZW5nbGlzaCxcbiAgICAgICAgICAgIC8vIGFuZCBmaW5hbGx5IHRvIHRoZSBmaXJzdCBsYW5ndWFnZSBhdmFpbGFibGUuIElmIHRoZXJlJ3Mgc3RpbGwgbm8gcG9saWN5XG4gICAgICAgICAgICAvLyBhdmFpbGFibGUgdGhlbiB0aGUgaG9tZXNlcnZlciBpc24ndCByZXNwZWN0aW5nIHRoZSBzcGVjLlxuICAgICAgICAgICAgbGV0IGxhbmdQb2xpY3kgPSBwb2xpY3lbcHJlZkxhbmddO1xuICAgICAgICAgICAgaWYgKCFsYW5nUG9saWN5KSBsYW5nUG9saWN5ID0gcG9saWN5W1wiZW5cIl07XG4gICAgICAgICAgICBpZiAoIWxhbmdQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAvLyBsYXN0IHJlc29ydFxuICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0TGFuZyA9IE9iamVjdC5rZXlzKHBvbGljeSkuZmluZChlID0+IGUgIT09IFwidmVyc2lvblwiKTtcbiAgICAgICAgICAgICAgICBsYW5nUG9saWN5ID0gcG9saWN5W2ZpcnN0TGFuZ107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWxhbmdQb2xpY3kpIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBmaW5kIGEgcG9saWN5IHRvIHNob3cgdGhlIHVzZXJcIik7XG5cbiAgICAgICAgICAgIGluaXRUb2dnbGVzW3BvbGljeUlkXSA9IGZhbHNlO1xuXG4gICAgICAgICAgICBwaWNrZWRQb2xpY2llcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogcG9saWN5SWQsXG4gICAgICAgICAgICAgICAgbmFtZTogbGFuZ1BvbGljeS5uYW1lLFxuICAgICAgICAgICAgICAgIHVybDogbGFuZ1BvbGljeS51cmwsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICB0b2dnbGVkUG9saWNpZXM6IGluaXRUb2dnbGVzLFxuICAgICAgICAgICAgcG9saWNpZXM6IHBpY2tlZFBvbGljaWVzLFxuICAgICAgICB9O1xuXG4gICAgICAgIENvdW50bHlBbmFseXRpY3MuaW5zdGFuY2UudHJhY2soXCJvbmJvYXJkaW5nX3Rlcm1zX2JlZ2luXCIpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLnByb3BzLm9uUGhhc2VDaGFuZ2UoREVGQVVMVF9QSEFTRSk7XG4gICAgfVxuXG4gICAgcHVibGljIHRyeUNvbnRpbnVlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnRyeVN1Ym1pdCgpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIHRvZ2dsZVBvbGljeShwb2xpY3lJZDogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IG5ld1RvZ2dsZXMgPSB7fTtcbiAgICAgICAgZm9yIChjb25zdCBwb2xpY3kgb2YgdGhpcy5zdGF0ZS5wb2xpY2llcykge1xuICAgICAgICAgICAgbGV0IGNoZWNrZWQgPSB0aGlzLnN0YXRlLnRvZ2dsZWRQb2xpY2llc1twb2xpY3kuaWRdO1xuICAgICAgICAgICAgaWYgKHBvbGljeS5pZCA9PT0gcG9saWN5SWQpIGNoZWNrZWQgPSAhY2hlY2tlZDtcblxuICAgICAgICAgICAgbmV3VG9nZ2xlc1twb2xpY3kuaWRdID0gY2hlY2tlZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgXCJ0b2dnbGVkUG9saWNpZXNcIjogbmV3VG9nZ2xlcyB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHRyeVN1Ym1pdCA9ICgpID0+IHtcbiAgICAgICAgbGV0IGFsbENoZWNrZWQgPSB0cnVlO1xuICAgICAgICBmb3IgKGNvbnN0IHBvbGljeSBvZiB0aGlzLnN0YXRlLnBvbGljaWVzKSB7XG4gICAgICAgICAgICBjb25zdCBjaGVja2VkID0gdGhpcy5zdGF0ZS50b2dnbGVkUG9saWNpZXNbcG9saWN5LmlkXTtcbiAgICAgICAgICAgIGFsbENoZWNrZWQgPSBhbGxDaGVja2VkICYmIGNoZWNrZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWxsQ2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5zdWJtaXRBdXRoRGljdCh7IHR5cGU6IEF1dGhUeXBlLlRlcm1zIH0pO1xuICAgICAgICAgICAgQ291bnRseUFuYWx5dGljcy5pbnN0YW5jZS50cmFjayhcIm9uYm9hcmRpbmdfdGVybXNfY29tcGxldGVcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgZXJyb3JUZXh0OiBfdChcIlBsZWFzZSByZXZpZXcgYW5kIGFjY2VwdCBhbGwgb2YgdGhlIGhvbWVzZXJ2ZXIncyBwb2xpY2llc1wiKSB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmJ1c3kpIHtcbiAgICAgICAgICAgIHJldHVybiA8U3Bpbm5lciAvPjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNoZWNrYm94ZXMgPSBbXTtcbiAgICAgICAgbGV0IGFsbENoZWNrZWQgPSB0cnVlO1xuICAgICAgICBmb3IgKGNvbnN0IHBvbGljeSBvZiB0aGlzLnN0YXRlLnBvbGljaWVzKSB7XG4gICAgICAgICAgICBjb25zdCBjaGVja2VkID0gdGhpcy5zdGF0ZS50b2dnbGVkUG9saWNpZXNbcG9saWN5LmlkXTtcbiAgICAgICAgICAgIGFsbENoZWNrZWQgPSBhbGxDaGVja2VkICYmIGNoZWNrZWQ7XG5cbiAgICAgICAgICAgIGNoZWNrYm94ZXMucHVzaChcbiAgICAgICAgICAgICAgICAvLyBYWFg6IHJlcGxhY2Ugd2l0aCBTdHlsZWRDaGVja2JveFxuICAgICAgICAgICAgICAgIDxsYWJlbCBrZXk9e1wicG9saWN5X2NoZWNrYm94X1wiICsgcG9saWN5LmlkfSBjbGFzc05hbWU9XCJteF9JbnRlcmFjdGl2ZUF1dGhFbnRyeUNvbXBvbmVudHNfdGVybXNQb2xpY3lcIj5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG9uQ2hhbmdlPXsoKSA9PiB0aGlzLnRvZ2dsZVBvbGljeShwb2xpY3kuaWQpfSBjaGVja2VkPXtjaGVja2VkfSAvPlxuICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXtwb2xpY3kudXJsfSB0YXJnZXQ9XCJfYmxhbmtcIiByZWw9XCJub3JlZmVycmVyIG5vb3BlbmVyXCI+eyBwb2xpY3kubmFtZSB9PC9hPlxuICAgICAgICAgICAgICAgIDwvbGFiZWw+LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBlcnJvclNlY3Rpb247XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmVycm9yVGV4dCB8fCB0aGlzLnN0YXRlLmVycm9yVGV4dCkge1xuICAgICAgICAgICAgZXJyb3JTZWN0aW9uID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZXJyb3JcIiByb2xlPVwiYWxlcnRcIj5cbiAgICAgICAgICAgICAgICAgICAgeyB0aGlzLnByb3BzLmVycm9yVGV4dCB8fCB0aGlzLnN0YXRlLmVycm9yVGV4dCB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHN1Ym1pdEJ1dHRvbjtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuc2hvd0NvbnRpbnVlICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgLy8gWFhYOiBidXR0b24gY2xhc3Nlc1xuICAgICAgICAgICAgc3VibWl0QnV0dG9uID0gPGJ1dHRvblxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X0ludGVyYWN0aXZlQXV0aEVudHJ5Q29tcG9uZW50c190ZXJtc1N1Ym1pdCBteF9HZW5lcmFsQnV0dG9uXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnRyeVN1Ym1pdH1cbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17IWFsbENoZWNrZWR9PnsgX3QoXCJBY2NlcHRcIikgfTwvYnV0dG9uPjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxwPnsgX3QoXCJQbGVhc2UgcmV2aWV3IGFuZCBhY2NlcHQgdGhlIHBvbGljaWVzIG9mIHRoaXMgaG9tZXNlcnZlcjpcIikgfTwvcD5cbiAgICAgICAgICAgICAgICB7IGNoZWNrYm94ZXMgfVxuICAgICAgICAgICAgICAgIHsgZXJyb3JTZWN0aW9uIH1cbiAgICAgICAgICAgICAgICB7IHN1Ym1pdEJ1dHRvbiB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmludGVyZmFjZSBJRW1haWxJZGVudGl0eUF1dGhFbnRyeVByb3BzIGV4dGVuZHMgSUF1dGhFbnRyeVByb3BzIHtcbiAgICBpbnB1dHM/OiB7XG4gICAgICAgIGVtYWlsQWRkcmVzcz86IHN0cmluZztcbiAgICB9O1xuICAgIHN0YWdlU3RhdGU/OiB7XG4gICAgICAgIGVtYWlsU2lkOiBzdHJpbmc7XG4gICAgfTtcbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3MuYXV0aC5FbWFpbElkZW50aXR5QXV0aEVudHJ5XCIpXG5leHBvcnQgY2xhc3MgRW1haWxJZGVudGl0eUF1dGhFbnRyeSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJRW1haWxJZGVudGl0eUF1dGhFbnRyeVByb3BzPiB7XG4gICAgc3RhdGljIExPR0lOX1RZUEUgPSBBdXRoVHlwZS5FbWFpbDtcblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLnByb3BzLm9uUGhhc2VDaGFuZ2UoREVGQVVMVF9QSEFTRSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgZXJyb3JTZWN0aW9uO1xuICAgICAgICAvLyBpZ25vcmUgdGhlIGVycm9yIHdoZW4gZXJyY29kZSBpcyBNX1VOQVVUSE9SSVpFRCBhcyB3ZSBleHBlY3QgdGhhdCBlcnJvciB1bnRpbCB0aGUgbGluayBpcyBjbGlja2VkLlxuICAgICAgICBpZiAodGhpcy5wcm9wcy5lcnJvclRleHQgJiYgdGhpcy5wcm9wcy5lcnJvckNvZGUgIT09IFwiTV9VTkFVVEhPUklaRURcIikge1xuICAgICAgICAgICAgZXJyb3JTZWN0aW9uID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZXJyb3JcIiByb2xlPVwiYWxlcnRcIj5cbiAgICAgICAgICAgICAgICAgICAgeyB0aGlzLnByb3BzLmVycm9yVGV4dCB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGhpcyBjb21wb25lbnQgaXMgbm93IG9ubHkgZGlzcGxheWVkIG9uY2UgdGhlIHRva2VuIGhhcyBiZWVuIHJlcXVlc3RlZCxcbiAgICAgICAgLy8gc28gd2Uga25vdyB0aGUgZW1haWwgaGFzIGJlZW4gc2VudC4gSXQgY2FuIGFsc28gZ2V0IGxvYWRlZCBhZnRlciB0aGUgdXNlclxuICAgICAgICAvLyBoYXMgY2xpY2tlZCB0aGUgdmFsaWRhdGlvbiBsaW5rIGlmIHRoZSBzZXJ2ZXIgdGFrZXMgYSB3aGlsZSB0byBwcm9wYWdhdGVcbiAgICAgICAgLy8gdGhlIHZhbGlkYXRpb24gaW50ZXJuYWxseS4gSWYgd2UncmUgaW4gdGhlIHNlc3Npb24gc3Bhd25lZCBmcm9tIGNsaWNraW5nXG4gICAgICAgIC8vIHRoZSB2YWxpZGF0aW9uIGxpbmssIHdlIHdvbid0IGtub3cgdGhlIGVtYWlsIGFkZHJlc3MsIHNvIGlmIHdlIGRvbid0IGhhdmUgaXQsXG4gICAgICAgIC8vIGFzc3VtZSB0aGF0IHRoZSBsaW5rIGhhcyBiZWVuIGNsaWNrZWQgYW5kIHRoZSBzZXJ2ZXIgd2lsbCByZWFsaXNlIHdoZW4gd2UgcG9sbC5cbiAgICAgICAgLy8gV2Ugb25seSBoYXZlIGEgc2Vzc2lvbiBJRCBpZiB0aGUgdXNlciBoYXMgY2xpY2tlZCB0aGUgbGluayBpbiB0aGVpciBlbWFpbCxcbiAgICAgICAgLy8gc28gc2hvdyBhIGxvYWRpbmcgc3RhdGUgaW5zdGVhZCBvZiBcImFuIGVtYWlsIGhhcyBiZWVuIHNlbnQgdG8uLi5cIiBiZWNhdXNlXG4gICAgICAgIC8vIHRoYXQncyBjb25mdXNpbmcgd2hlbiB5b3UndmUgYWxyZWFkeSByZWFkIHRoYXQgZW1haWwuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmlucHV0cy5lbWFpbEFkZHJlc3MgPT09IHVuZGVmaW5lZCB8fCB0aGlzLnByb3BzLnN0YWdlU3RhdGU/LmVtYWlsU2lkKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3JTZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yU2VjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiA8U3Bpbm5lciAvPjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9JbnRlcmFjdGl2ZUF1dGhFbnRyeUNvbXBvbmVudHNfZW1haWxXcmFwcGVyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxwPnsgX3QoXCJBIGNvbmZpcm1hdGlvbiBlbWFpbCBoYXMgYmVlbiBzZW50IHRvICUoZW1haWxBZGRyZXNzKXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgZW1haWxBZGRyZXNzOiA8Yj57IHRoaXMucHJvcHMuaW5wdXRzLmVtYWlsQWRkcmVzcyB9PC9iPiB9LFxuICAgICAgICAgICAgICAgICAgICApIH1cbiAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICA8cD57IF90KFwiT3BlbiB0aGUgbGluayBpbiB0aGUgZW1haWwgdG8gY29udGludWUgcmVnaXN0cmF0aW9uLlwiKSB9PC9wPlxuICAgICAgICAgICAgICAgICAgICB7IGVycm9yU2VjdGlvbiB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5pbnRlcmZhY2UgSU1zaXNkbkF1dGhFbnRyeVByb3BzIGV4dGVuZHMgSUF1dGhFbnRyeVByb3BzIHtcbiAgICBpbnB1dHM6IHtcbiAgICAgICAgcGhvbmVDb3VudHJ5OiBzdHJpbmc7XG4gICAgICAgIHBob25lTnVtYmVyOiBzdHJpbmc7XG4gICAgfTtcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZztcbiAgICBmYWlsOiAoZXJyb3I6IEVycm9yKSA9PiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgSU1zaXNkbkF1dGhFbnRyeVN0YXRlIHtcbiAgICB0b2tlbjogc3RyaW5nO1xuICAgIHJlcXVlc3RpbmdUb2tlbjogYm9vbGVhbjtcbiAgICBlcnJvclRleHQ6IHN0cmluZztcbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3MuYXV0aC5Nc2lzZG5BdXRoRW50cnlcIilcbmV4cG9ydCBjbGFzcyBNc2lzZG5BdXRoRW50cnkgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SU1zaXNkbkF1dGhFbnRyeVByb3BzLCBJTXNpc2RuQXV0aEVudHJ5U3RhdGU+IHtcbiAgICBzdGF0aWMgTE9HSU5fVFlQRSA9IEF1dGhUeXBlLk1zaXNkbjtcblxuICAgIHByaXZhdGUgc3VibWl0VXJsOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBzaWQ6IHN0cmluZztcbiAgICBwcml2YXRlIG1zaXNkbjogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICB0b2tlbjogJycsXG4gICAgICAgICAgICByZXF1ZXN0aW5nVG9rZW46IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3JUZXh0OiAnJyxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5vblBoYXNlQ2hhbmdlKERFRkFVTFRfUEhBU0UpO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyByZXF1ZXN0aW5nVG9rZW46IHRydWUgfSk7XG4gICAgICAgIHRoaXMucmVxdWVzdE1zaXNkblRva2VuKCkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZmFpbChlKTtcbiAgICAgICAgfSkuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVxdWVzdGluZ1Rva2VuOiBmYWxzZSB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBSZXF1ZXN0cyBhIHZlcmlmaWNhdGlvbiB0b2tlbiBieSBTTVMuXG4gICAgICovXG4gICAgcHJpdmF0ZSByZXF1ZXN0TXNpc2RuVG9rZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLm1hdHJpeENsaWVudC5yZXF1ZXN0UmVnaXN0ZXJNc2lzZG5Ub2tlbihcbiAgICAgICAgICAgIHRoaXMucHJvcHMuaW5wdXRzLnBob25lQ291bnRyeSxcbiAgICAgICAgICAgIHRoaXMucHJvcHMuaW5wdXRzLnBob25lTnVtYmVyLFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5jbGllbnRTZWNyZXQsXG4gICAgICAgICAgICAxLCAvLyBUT0RPOiBNdWx0aXBsZSBzZW5kIGF0dGVtcHRzP1xuICAgICAgICApLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdWJtaXRVcmwgPSByZXN1bHQuc3VibWl0X3VybDtcbiAgICAgICAgICAgIHRoaXMuc2lkID0gcmVzdWx0LnNpZDtcbiAgICAgICAgICAgIHRoaXMubXNpc2RuID0gcmVzdWx0Lm1zaXNkbjtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblRva2VuQ2hhbmdlID0gKGU6IENoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgdG9rZW46IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkZvcm1TdWJtaXQgPSBhc3luYyAoZTogRm9ybUV2ZW50KSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUudG9rZW4gPT0gJycpIHJldHVybjtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGVycm9yVGV4dDogbnVsbCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgICAgICBpZiAodGhpcy5zdWJtaXRVcmwpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLnByb3BzLm1hdHJpeENsaWVudC5zdWJtaXRNc2lzZG5Ub2tlbk90aGVyVXJsKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1Ym1pdFVybCwgdGhpcy5zaWQsIHRoaXMucHJvcHMuY2xpZW50U2VjcmV0LCB0aGlzLnN0YXRlLnRva2VuLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSByZWdpc3RyYXRpb24gd2l0aCBNU0lTRE4gZmxvdyBpcyBtaXNjb25maWd1cmVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3JlZHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHNpZDogdGhpcy5zaWQsXG4gICAgICAgICAgICAgICAgICAgIGNsaWVudF9zZWNyZXQ6IHRoaXMucHJvcHMuY2xpZW50U2VjcmV0LFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5zdWJtaXRBdXRoRGljdCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IEF1dGhUeXBlLk1zaXNkbixcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogUmVtb3ZlIGB0aHJlZXBpZF9jcmVkc2Agb25jZSBzZXJ2ZXJzIHN1cHBvcnQgcHJvcGVyIFVJQVxuICAgICAgICAgICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlY3Rvci1pbS9lbGVtZW50LXdlYi9pc3N1ZXMvMTAzMTJcbiAgICAgICAgICAgICAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tYXRyaXgtb3JnL21hdHJpeC1kb2MvaXNzdWVzLzIyMjBcbiAgICAgICAgICAgICAgICAgICAgdGhyZWVwaWRfY3JlZHM6IGNyZWRzLFxuICAgICAgICAgICAgICAgICAgICB0aHJlZXBpZENyZWRzOiBjcmVkcyxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yVGV4dDogX3QoXCJUb2tlbiBpbmNvcnJlY3RcIiksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZmFpbChlKTtcbiAgICAgICAgICAgIGxvZ2dlci5sb2coXCJGYWlsZWQgdG8gc3VibWl0IG1zaXNkbiB0b2tlblwiKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnJlcXVlc3RpbmdUb2tlbikge1xuICAgICAgICAgICAgcmV0dXJuIDxTcGlubmVyIC8+O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZW5hYmxlU3VibWl0ID0gQm9vbGVhbih0aGlzLnN0YXRlLnRva2VuKTtcbiAgICAgICAgICAgIGNvbnN0IHN1Ym1pdENsYXNzZXMgPSBjbGFzc05hbWVzKHtcbiAgICAgICAgICAgICAgICBteF9JbnRlcmFjdGl2ZUF1dGhFbnRyeUNvbXBvbmVudHNfbXNpc2RuU3VibWl0OiB0cnVlLFxuICAgICAgICAgICAgICAgIG14X0dlbmVyYWxCdXR0b246IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxldCBlcnJvclNlY3Rpb247XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5lcnJvclRleHQpIHtcbiAgICAgICAgICAgICAgICBlcnJvclNlY3Rpb24gPSAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZXJyb3JcIiByb2xlPVwiYWxlcnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgdGhpcy5zdGF0ZS5lcnJvclRleHQgfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICA8cD57IF90KFwiQSB0ZXh0IG1lc3NhZ2UgaGFzIGJlZW4gc2VudCB0byAlKG1zaXNkbilzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IG1zaXNkbjogPGk+eyB0aGlzLm1zaXNkbiB9PC9pPiB9LFxuICAgICAgICAgICAgICAgICAgICApIH1cbiAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICA8cD57IF90KFwiUGxlYXNlIGVudGVyIHRoZSBjb2RlIGl0IGNvbnRhaW5zOlwiKSB9PC9wPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0ludGVyYWN0aXZlQXV0aEVudHJ5Q29tcG9uZW50c19tc2lzZG5XcmFwcGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17dGhpcy5vbkZvcm1TdWJtaXR9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X0ludGVyYWN0aXZlQXV0aEVudHJ5Q29tcG9uZW50c19tc2lzZG5FbnRyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnRva2VufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vblRva2VuQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPXtfdChcIkNvZGVcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtfdChcIlN1Ym1pdFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtzdWJtaXRDbGFzc2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IWVuYWJsZVN1Ym1pdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBlcnJvclNlY3Rpb24gfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmludGVyZmFjZSBJU1NPQXV0aEVudHJ5UHJvcHMgZXh0ZW5kcyBJQXV0aEVudHJ5UHJvcHMge1xuICAgIGNvbnRpbnVlVGV4dD86IHN0cmluZztcbiAgICBjb250aW51ZUtpbmQ/OiBzdHJpbmc7XG4gICAgb25DYW5jZWw/OiAoKSA9PiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgSVNTT0F1dGhFbnRyeVN0YXRlIHtcbiAgICBwaGFzZTogbnVtYmVyO1xuICAgIGF0dGVtcHRGYWlsZWQ6IGJvb2xlYW47XG59XG5cbkByZXBsYWNlYWJsZUNvbXBvbmVudChcInZpZXdzLmF1dGguU1NPQXV0aEVudHJ5XCIpXG5leHBvcnQgY2xhc3MgU1NPQXV0aEVudHJ5IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PElTU09BdXRoRW50cnlQcm9wcywgSVNTT0F1dGhFbnRyeVN0YXRlPiB7XG4gICAgc3RhdGljIExPR0lOX1RZUEUgPSBBdXRoVHlwZS5Tc287XG4gICAgc3RhdGljIFVOU1RBQkxFX0xPR0lOX1RZUEUgPSBBdXRoVHlwZS5Tc29VbnN0YWJsZTtcblxuICAgIHN0YXRpYyBQSEFTRV9QUkVBVVRIID0gMTsgLy8gYnV0dG9uIHRvIHN0YXJ0IFNTT1xuICAgIHN0YXRpYyBQSEFTRV9QT1NUQVVUSCA9IDI7IC8vIGJ1dHRvbiB0byBjb25maXJtIFNTTyBjb21wbGV0ZWRcblxuICAgIHByaXZhdGUgc3NvVXJsOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBwb3B1cFdpbmRvdzogV2luZG93O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIC8vIFdlIGFjdHVhbGx5IHNlbmQgdGhlIHVzZXIgdGhyb3VnaCBmYWxsYmFjayBhdXRoIHNvIHdlIGRvbid0IGhhdmUgdG9cbiAgICAgICAgLy8gZGVhbCB3aXRoIGEgcmVkaXJlY3QgYmFjayB0byB1cywgbG9zaW5nIGFwcGxpY2F0aW9uIGNvbnRleHQuXG4gICAgICAgIHRoaXMuc3NvVXJsID0gcHJvcHMubWF0cml4Q2xpZW50LmdldEZhbGxiYWNrQXV0aFVybChcbiAgICAgICAgICAgIHRoaXMucHJvcHMubG9naW5UeXBlLFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hdXRoU2Vzc2lvbklkLFxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMucG9wdXBXaW5kb3cgPSBudWxsO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5vblJlY2VpdmVNZXNzYWdlKTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgcGhhc2U6IFNTT0F1dGhFbnRyeS5QSEFTRV9QUkVBVVRILFxuICAgICAgICAgICAgYXR0ZW1wdEZhaWxlZDogZmFsc2UsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25QaGFzZUNoYW5nZShTU09BdXRoRW50cnkuUEhBU0VfUFJFQVVUSCk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCB0aGlzLm9uUmVjZWl2ZU1lc3NhZ2UpO1xuICAgICAgICBpZiAodGhpcy5wb3B1cFdpbmRvdykge1xuICAgICAgICAgICAgdGhpcy5wb3B1cFdpbmRvdy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5wb3B1cFdpbmRvdyA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXR0ZW1wdEZhaWxlZCA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBhdHRlbXB0RmFpbGVkOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblJlY2VpdmVNZXNzYWdlID0gKGV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGV2ZW50LmRhdGEgPT09IFwiYXV0aERvbmVcIiAmJiBldmVudC5vcmlnaW4gPT09IHRoaXMucHJvcHMubWF0cml4Q2xpZW50LmdldEhvbWVzZXJ2ZXJVcmwoKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucG9wdXBXaW5kb3cpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwV2luZG93LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cFdpbmRvdyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblN0YXJ0QXV0aENsaWNrID0gKCkgPT4ge1xuICAgICAgICAvLyBOb3RlOiBXZSBkb24ndCB1c2UgUGxhdGZvcm1QZWcncyBzdGFydFNzb0F1dGggZnVuY3Rpb25zIGJlY2F1c2Ugd2UgYWxtb3N0XG4gICAgICAgIC8vIGNlcnRhaW5seSB3aWxsIG5lZWQgdG8gb3BlbiB0aGUgdGhpbmcgaW4gYSBuZXcgdGFiIHRvIGF2b2lkIGxvc2luZyBhcHBsaWNhdGlvblxuICAgICAgICAvLyBjb250ZXh0LlxuXG4gICAgICAgIHRoaXMucG9wdXBXaW5kb3cgPSB3aW5kb3cub3Blbih0aGlzLnNzb1VybCwgXCJfYmxhbmtcIik7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBwaGFzZTogU1NPQXV0aEVudHJ5LlBIQVNFX1BPU1RBVVRIIH0pO1xuICAgICAgICB0aGlzLnByb3BzLm9uUGhhc2VDaGFuZ2UoU1NPQXV0aEVudHJ5LlBIQVNFX1BPU1RBVVRIKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNvbmZpcm1DbGljayA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5wcm9wcy5zdWJtaXRBdXRoRGljdCh7fSk7XG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IGNvbnRpbnVlQnV0dG9uID0gbnVsbDtcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gKFxuICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2FuY2VsfVxuICAgICAgICAgICAgICAgIGtpbmQ9e3RoaXMucHJvcHMuY29udGludWVLaW5kID8gKHRoaXMucHJvcHMuY29udGludWVLaW5kICsgJ19vdXRsaW5lJykgOiAncHJpbWFyeV9vdXRsaW5lJ31cbiAgICAgICAgICAgID57IF90KFwiQ2FuY2VsXCIpIH08L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICk7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnBoYXNlID09PSBTU09BdXRoRW50cnkuUEhBU0VfUFJFQVVUSCkge1xuICAgICAgICAgICAgY29udGludWVCdXR0b24gPSAoXG4gICAgICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vblN0YXJ0QXV0aENsaWNrfVxuICAgICAgICAgICAgICAgICAgICBraW5kPXt0aGlzLnByb3BzLmNvbnRpbnVlS2luZCB8fCAncHJpbWFyeSd9XG4gICAgICAgICAgICAgICAgPnsgdGhpcy5wcm9wcy5jb250aW51ZVRleHQgfHwgX3QoXCJTaW5nbGUgU2lnbiBPblwiKSB9PC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRpbnVlQnV0dG9uID0gKFxuICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25Db25maXJtQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIGtpbmQ9e3RoaXMucHJvcHMuY29udGludWVLaW5kIHx8ICdwcmltYXJ5J31cbiAgICAgICAgICAgICAgICA+eyB0aGlzLnByb3BzLmNvbnRpbnVlVGV4dCB8fCBfdChcIkNvbmZpcm1cIikgfTwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZXJyb3JTZWN0aW9uO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5lcnJvclRleHQpIHtcbiAgICAgICAgICAgIGVycm9yU2VjdGlvbiA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImVycm9yXCIgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgICAgICAgICAgIHsgdGhpcy5wcm9wcy5lcnJvclRleHQgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXRlLmF0dGVtcHRGYWlsZWQpIHtcbiAgICAgICAgICAgIGVycm9yU2VjdGlvbiA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImVycm9yXCIgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgICAgICAgICAgIHsgX3QoXCJTb21ldGhpbmcgd2VudCB3cm9uZyBpbiBjb25maXJtaW5nIHlvdXIgaWRlbnRpdHkuIENhbmNlbCBhbmQgdHJ5IGFnYWluLlwiKSB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDxSZWFjdC5GcmFnbWVudD5cbiAgICAgICAgICAgIHsgZXJyb3JTZWN0aW9uIH1cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfSW50ZXJhY3RpdmVBdXRoRW50cnlDb21wb25lbnRzX3Nzb19idXR0b25zXCI+XG4gICAgICAgICAgICAgICAgeyBjYW5jZWxCdXR0b24gfVxuICAgICAgICAgICAgICAgIHsgY29udGludWVCdXR0b24gfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+O1xuICAgIH1cbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3MuYXV0aC5GYWxsYmFja0F1dGhFbnRyeVwiKVxuZXhwb3J0IGNsYXNzIEZhbGxiYWNrQXV0aEVudHJ5IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PElBdXRoRW50cnlQcm9wcz4ge1xuICAgIHByaXZhdGUgcG9wdXBXaW5kb3c6IFdpbmRvdztcbiAgICBwcml2YXRlIGZhbGxiYWNrQnV0dG9uID0gY3JlYXRlUmVmPEhUTUxBbmNob3JFbGVtZW50PigpO1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIC8vIHdlIGhhdmUgdG8gbWFrZSB0aGUgdXNlciBjbGljayBhIGJ1dHRvbiwgYXMgYnJvd3NlcnMgd2lsbCBibG9ja1xuICAgICAgICAvLyB0aGUgcG9wdXAgaWYgd2Ugb3BlbiBpdCBpbW1lZGlhdGVseS5cbiAgICAgICAgdGhpcy5wb3B1cFdpbmRvdyA9IG51bGw7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCB0aGlzLm9uUmVjZWl2ZU1lc3NhZ2UpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLnByb3BzLm9uUGhhc2VDaGFuZ2UoREVGQVVMVF9QSEFTRSk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCB0aGlzLm9uUmVjZWl2ZU1lc3NhZ2UpO1xuICAgICAgICBpZiAodGhpcy5wb3B1cFdpbmRvdykge1xuICAgICAgICAgICAgdGhpcy5wb3B1cFdpbmRvdy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGZvY3VzID0gKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5mYWxsYmFja0J1dHRvbi5jdXJyZW50KSB7XG4gICAgICAgICAgICB0aGlzLmZhbGxiYWNrQnV0dG9uLmN1cnJlbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uU2hvd0ZhbGxiYWNrQ2xpY2sgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5wcm9wcy5tYXRyaXhDbGllbnQuZ2V0RmFsbGJhY2tBdXRoVXJsKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5sb2dpblR5cGUsXG4gICAgICAgICAgICB0aGlzLnByb3BzLmF1dGhTZXNzaW9uSWQsXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMucG9wdXBXaW5kb3cgPSB3aW5kb3cub3Blbih1cmwsIFwiX2JsYW5rXCIpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUmVjZWl2ZU1lc3NhZ2UgPSAoZXZlbnQ6IE1lc3NhZ2VFdmVudCkgPT4ge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBldmVudC5kYXRhID09PSBcImF1dGhEb25lXCIgJiZcbiAgICAgICAgICAgIGV2ZW50Lm9yaWdpbiA9PT0gdGhpcy5wcm9wcy5tYXRyaXhDbGllbnQuZ2V0SG9tZXNlcnZlclVybCgpXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5zdWJtaXRBdXRoRGljdCh7fSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgZXJyb3JTZWN0aW9uO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5lcnJvclRleHQpIHtcbiAgICAgICAgICAgIGVycm9yU2VjdGlvbiA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImVycm9yXCIgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgICAgICAgICAgIHsgdGhpcy5wcm9wcy5lcnJvclRleHQgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8YSBocmVmPVwiXCIgcmVmPXt0aGlzLmZhbGxiYWNrQnV0dG9ufSBvbkNsaWNrPXt0aGlzLm9uU2hvd0ZhbGxiYWNrQ2xpY2t9PntcbiAgICAgICAgICAgICAgICAgICAgX3QoXCJTdGFydCBhdXRoZW50aWNhdGlvblwiKVxuICAgICAgICAgICAgICAgIH08L2E+XG4gICAgICAgICAgICAgICAgeyBlcnJvclNlY3Rpb24gfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElTdGFnZUNvbXBvbmVudFByb3BzIGV4dGVuZHMgSUF1dGhFbnRyeVByb3BzIHtcbiAgICBjbGllbnRTZWNyZXQ/OiBzdHJpbmc7XG4gICAgc3RhZ2VQYXJhbXM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICAgIGlucHV0cz86IElJbnB1dHM7XG4gICAgc3RhZ2VTdGF0ZT86IElTdGFnZVN0YXR1cztcbiAgICBzaG93Q29udGludWU/OiBib29sZWFuO1xuICAgIGNvbnRpbnVlVGV4dD86IHN0cmluZztcbiAgICBjb250aW51ZUtpbmQ/OiBzdHJpbmc7XG4gICAgZmFpbD8oZTogRXJyb3IpOiB2b2lkO1xuICAgIHNldEVtYWlsU2lkPyhzaWQ6IHN0cmluZyk6IHZvaWQ7XG4gICAgb25DYW5jZWw/KCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVN0YWdlQ29tcG9uZW50IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50Q2xhc3M8UmVhY3QuUHJvcHNXaXRoUmVmPElTdGFnZUNvbXBvbmVudFByb3BzPj4ge1xuICAgIHRyeUNvbnRpbnVlPygpOiB2b2lkO1xuICAgIGF0dGVtcHRGYWlsZWQ/KCk6IHZvaWQ7XG4gICAgZm9jdXM/KCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEVudHJ5Q29tcG9uZW50Rm9yTG9naW5UeXBlKGxvZ2luVHlwZTogQXV0aFR5cGUpOiBJU3RhZ2VDb21wb25lbnQge1xuICAgIHN3aXRjaCAobG9naW5UeXBlKSB7XG4gICAgICAgIGNhc2UgQXV0aFR5cGUuUGFzc3dvcmQ6XG4gICAgICAgICAgICByZXR1cm4gUGFzc3dvcmRBdXRoRW50cnk7XG4gICAgICAgIGNhc2UgQXV0aFR5cGUuUmVjYXB0Y2hhOlxuICAgICAgICAgICAgcmV0dXJuIFJlY2FwdGNoYUF1dGhFbnRyeTtcbiAgICAgICAgY2FzZSBBdXRoVHlwZS5FbWFpbDpcbiAgICAgICAgICAgIHJldHVybiBFbWFpbElkZW50aXR5QXV0aEVudHJ5O1xuICAgICAgICBjYXNlIEF1dGhUeXBlLk1zaXNkbjpcbiAgICAgICAgICAgIHJldHVybiBNc2lzZG5BdXRoRW50cnk7XG4gICAgICAgIGNhc2UgQXV0aFR5cGUuVGVybXM6XG4gICAgICAgICAgICByZXR1cm4gVGVybXNBdXRoRW50cnk7XG4gICAgICAgIGNhc2UgQXV0aFR5cGUuU3NvOlxuICAgICAgICBjYXNlIEF1dGhUeXBlLlNzb1Vuc3RhYmxlOlxuICAgICAgICAgICAgcmV0dXJuIFNTT0F1dGhFbnRyeTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBGYWxsYmFja0F1dGhFbnRyeTtcbiAgICB9XG59XG4iXX0=