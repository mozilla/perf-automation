webpackJsonp([52],{1280:function(t,e,n){t.exports={controllerViews:{CanvasStickyShareButtons:n(3169)},meta:{dependencies:["tdv2-applet-canvass","tdv2-applet-follow","react-share-buttons"],langBundle:"tdv2-applet-content-canvas"}}},1590:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(10)),i=o(n(29)),r={article:"story"},a="undefined"!=typeof window;e.default={isLazyLoad:function(t,e){return e>=0&&t<e},isSidekick:function(t){return t&&-1!==t.indexOf("SIDEKICK")},updateQueryParam:function(t,e){e=e||{};var n=i.default.parse(t,!0);return n.search=void 0,n.query=Object.assign({},n.query,e),i.default.format(n)},getLoopIndex:function(t,e,n){if(!n)return t+e;var o=(t+e)%n;return o<0?o+n:o},getRelatedUuids:function(t,e,n){var o=e.length,s=[];if(0===o||0===t||n>=o)return s;for(var i=n;s.length<t&&(i=++i%o)!==n;)e[i]&&e[i].uuid&&s.push(e[i].uuid);return s},getResizedImage:function(t,e){return t=t||{},t[e]||t.original},getCommentString:function(t){if(!t)return"";return t>=1e6?parseFloat((t/1e6).toFixed(2))+"m":t>=1e5?parseFloat((t/1e3).toFixed(0))+"k":t>=1e3?parseFloat((t/1e3).toFixed(1))+"k":t.toString()},getBaseI13n:function(t,e,n){var o=t.type,s={itc:0,g:t.uuid||t.id};this.isSidekick(n)?(s.cat=n,s.ccode=t.ccode,s.ct=r[o]||o,s.subsec="sentiment",s.sec="sdkick"):s.sec="jtc";var i=this.parseUrl(t.link||t.url||"");i&&(s.tar=i.host,s.tar_uri=i.pathname);var a=t.title;return a&&(s.slk=a),s.cpos=e+1,s.pos=e+1,s},getTypeIcon:function(t){var e=["video","slideshow"],n=t.type;return e.indexOf(n)>=0?n:""},getSentimentsRatio:function(t,e,n){if(void 0===t||void 0===n||void 0===e)return null;var o=t+n+e;if(!o)return null;var s=Math.round(t/o*100),i=Math.round(n/o*100);return{negative:s,neutral:i,positive:100-s-i}},parseUrl:function(t){if(t=t.split("?")[0]){if("/"===t.charAt(0))return{host:a?window.location.host:"",pathname:t,protocol:a?window.location.protocol:""};var e=t.split("/");return{host:e[2],pathname:"/"+e.slice(3).join("/"),protocol:e[0]}}return null},processStreamData:function(t){var e=t.get("comments")||s.default.Map(),n=e.toJS(),o=t.get("images")||s.default.Map();return{bypassModal:t.get("bypassModal"),ccode:t.get("ccCode"),commentCount:parseInt(n.totalCount,10)||0,imageSize:o.toJS(),link:t.get("link")||"",title:t.get("title")||"",topRatedComments:n.topRated||[],total_negative_comments:parseInt(n.negativeCount,10)||0,total_neutral_comments:parseInt(n.neutralCount,10)||0,total_postive_comments:parseInt(n.positiveCount,10)||0,type:t.get("subtype")||t.get("type"),uuid:t.get("id")||""}}},t.exports=e.default},1665:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n){c("expand",e);var o=e&&(e.id||e.instanceId);if(!o)return n&&n(new Error("expandMessages requires an instanceId"));var s=t.session.query,a=t.getStore(r.default).getState(),f=t.getStore(i.default),p=f.getCommentsState(o),h=p.get("messageList")||l.default.List(),m={id:o,instanceId:o,isExpanded:(0,u.default)(e,["expanded"],!0)};if(!m.isExpanded||h.size>0||m.isExpanded===p.get("expanded"))t.dispatch("COMMENTS_EXPAND",m),n&&n();else{var g={context:e.uuid||e.context||s.context||"YahooGlobal",contextDisplayText:e.contextDisplayText||p.get("contextDisplayText"),contextUrl:e.contextUrl||p.get("contextUrl"),expanded:!0,index:e.nextIndex||null,instanceId:o,lang:a.lang,messagesPerPage:a.messagesPerPage,namespace:e.namespace||p.get("namespace")||a.namespace,region:a.region,selectedTags:e.selectedTags,sortBy:e.sortBy||p.get("sortBy"),tagsAnd:e.tagsAnd,tagsOr:e.tagsOr,oauthConsumerKey:a.oauthConsumerKey,oauthConsumerSecret:a.oauthConsumerSecret};t.executeAction(d.default,g,function(e,s){f.getCommentsState(o).get("error")||t.dispatch("COMMENTS_EXPAND",m),n&&n()})}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(287)),r=o(n(113)),a=o(n(3)),u=o(n(2)),l=o(n(10)),d=o(n(507)),c=(0,a.default)("Canvass:actions:expandMessages");s.displayName="expandMessages",e.default=s,t.exports=e.default},1865:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(1)),i=o(n(0)),r=o(n(4)),a="undefined"!=typeof window?window:null;e.default=(0,r.default)({autobind:!1,displayName:"Flyout",propTypes:{align:i.default.oneOf(["left","right"]),alignToViewport:i.default.bool,componentProps:i.default.object.isRequired,fixedToParent:i.default.bool,flyoutWidth:i.default.number,flyoutHeight:i.default.number,onMouseEnter:i.default.func,onMouseLeave:i.default.func,parentNode:i.default.object.isRequired,relativeToParent:i.default.bool,triangleFillColor:i.default.string},getDefaultProps:function(){return{align:"right",Component:null,componentProps:{},flyoutWidth:370,flyoutHeight:482,parentNode:null,relativeToParent:!1,triangleFillColor:"#fff"}},calculatePositions:function(){var t=this.props;if(!a)return null;var e=t.flyoutHeight,n=t.parentNode&&t.parentNode.getBoundingClientRect();if(!n)return null;var o=n.height/2,s=0;t.fixedToParent&&(s=n.top-a.innerHeight+e);var i=a.innerHeight-n.top;if(t.alignToViewport&&i<e){var r=this.getViewPortAlignedPos(i,s,e,n.height);o=r.arrow,s=r.flyout}return"left"===t.align?this.getLeftAlignedFlyoutStyles(o,s,n.top,n.left):"right"===t.align?this.getRightAlignedFlyoutStyles(o,s,n.top,n.right):null},getLeftAlignedFlyoutStyles:function(t,e,n,o){var s=this.props,i=-(s.flyoutWidth+s.paddingRight);return s.relativeToParent||(e+=n,i+=o),{arrowStyles:{left:s.flyoutWidth+1,top:t,transform:"rotate(180deg)"},wrapperStyles:{left:i,top:e}}},getRightAlignedFlyoutStyles:function(t,e,n,o){var s=this.props,i=-(s.flyoutWidth+s.paddingLeft);return s.relativeToParent||(e+=n,i=-(i+o)),{arrowStyles:{right:s.flyoutWidth-1,top:t},wrapperStyles:{right:i,top:e}}},getViewPortAlignedPos:function(t,e,n,o){var s=t<o/2,i=n-t;return{arrow:s?i:i+o/2,flyout:-i}},render:function(){var t=this.props,e=t.Component;if(!e||!t.parentNode)return null;var n=this.calculatePositions();if(!n)return null;var o={height:t.flyoutHeight,width:t.flyoutWidth,paddingTop:t.paddingTop||0,paddingBottom:t.paddingBottom||0,paddingLeft:t.paddingLeft||0,paddingRight:t.paddingRight||0},i=n.arrowStyles,r=t.componentProps,a=Object.assign({},o,n.wrapperStyles),u={borderRightColor:t.triangleFillColor};return s.default.createElement("div",{className:"Pos(a)",style:a,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave},s.default.createElement(e,r),s.default.createElement("div",{className:"Z(3) C(t) Pos(a) W(0) H(0) Bds(s) Bdtc(t) Bdbc(t) Bdendc($c-fuji-grey-e) Bdendw(12px) Bdtw(12px) Bdbw(12px)",style:i},s.default.createElement("div",{className:"Pos(r) Scale(1.4) T(-9px) W(0) H(0) Bdtc(t) Bdbc(t) Bds(s) Bdtw(9px) Bdbw(9px) Bdendw(9px)",style:u})))}}),t.exports=e.default},1899:function(t,e,n){"use strict";function o(t,e){if(!t)return null;var o=(0,n(11).get)(t,"summary")||"",r=(0,n(11).get)(t,"title")||"";"slideshow"===(0,n(11).get)(t,"contentType")&&o.length>i&&(o=r);var a=(0,s.default)(e,["layout","image"],"");return{uuid:(0,n(11).get)(t,"uuid")||"",link:(0,n(11).get)(t,"url")||"",alias:(0,n(11).get)(t,"alias")||"",title:r,description:o,picture:(0,n(11).getIn)(t,["thumbnail","url"])||a}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var s=function(t){return t&&t.__esModule?t:{default:t}}(n(2)),i=800;t.exports=e.default},2066:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(10)),i=o(n(0)),r=o(n(1)),a=o(n(154)),u=o(n(1223)),l=o(n(205)),d=o(n(110)),c=o(n(7)),f=o(n(5)),p=o(n(62)),h=o(n(2)),m=o(n(1899));e.default={statics:{storeListeners:[d.default]},contextTypes:{getStore:i.default.func.isRequired,renderTarget:i.default.object,session:i.default.object.isRequired},propTypes:{alignLeft:i.default.bool,buttonSpacingPixels:i.default.number,contentId:i.default.string,commentScrollMarginTop:i.default.number,iconSize:i.default.number,maxSquareWidth:i.default.number,minSquareWidth:i.default.number,orientation:i.default.string,persistToolTip:i.default.bool,roundButtonDiameter:i.default.number,shouldUseBrowserUrl:i.default.bool,showTooltipAtBottom:i.default.bool,useButtonColorForBackground:i.default.bool,hideText:i.default.bool,ylkData:i.default.object},getDefaultProps:function(){return{alignLeft:!1,buttonSpacingPixels:8,contentId:void 0,commentScrollMarginTop:void 0,iconSize:20,maxSquareWidth:void 0,minSquareWidth:void 0,orientation:a.default.orientation.HORIZONTAL,persistToolTip:!1,roundButtonDiameter:40,shouldUseBrowserUrl:!0,showTooltipAtBottom:!1,useButtonColorForBackground:!0,hideText:!1,ylkData:{}}},getInitialState:function(){return this.config=(0,h.default)(this.props,["componentConfig","shareButtons"])||{},this.contentStore=this.getStore(d.default),this.langStore=this.getStore("LangStore"),this.pageStore=this.getStore(c.default),this.routeStore=this.getStore("RouteStore"),this._getState(this.props.contentId)},onChange:function(t){this.props.contentId||this.setState(this._getState())},componentWillReceiveProps:function(t){t.contentId!==this.props.contentId&&this.setState(this._getState(t.contentId))},_getState:function(t){var e=this.contentStore,o=this.context.renderTarget||{},i=t?e.getContentByUUID(t):e.getCurrentContent(o.id),r=this.routeStore.getCurrentRoute()||{},a={};this.pageStore&&(a=this.pageStore.getPageConfig()),i=i||{};var u=(0,n(11).get)(i,"uuid")||"",l=(0,m.default)(i,a),d=p.default.isLcpContent(i);return{buttons:s.default.List(d?this.config.lcpButtons:this.config.buttons),isLcp:d,isCurrentRenderTarget:this._isCurrentRenderTarget(),shareMeta:l,site:p.default.getContentSite(r,this.context),twitterId:this._getTwitterId(),uuid:u,ylk:Object.assign({},this.props.ylkData,{uuid:u})}},_isCurrentRenderTarget:function(){return(0,h.default)(this,["context","renderTarget","id"])===(this.pageStore&&this.pageStore.getCurrentRenderTargetId())},_getDevice:function(){return(0,h.default)(this.context,["session","dimensions","device"],"smartphone")},_getTwitterId:function(){var t=this.pageStore.getPageData(),e=(0,h.default)(t,["meta","property","twitter:site"])||(0,h.default)(t,["meta","name","twitter:site"])||"Yahoo";return"@"===e.charAt(0)&&(e=e.slice(1)),e},_getStyles:function(t){return(0,h.default)(this.config,["styles",t])},renderLikeButton:function(){var t=this.config;if(!this.props.enableLikeButton||this.state.isLcp||!this.state.uuid)return null;var e={initial:"#f23347",hovered:"#f23347"};t.enableRoundShareButtons&&(e={initial:"#fff",hovered:"#d1282d",selected:"#ff4d53"});var n={className:this._getStyles("likeButtonClasses"),colors:e,enableRoundShape:t.enableRoundShareButtons,enableHoverColor:t.enableHoverColor,enableHoverColorTransition:t.enableHoverColorTransition,enableTooltip:this.props.persistToolTip,iconClasses:this._getStyles("likeIconClasses"),iconSize:this.props.iconSize,overrideTooltipClasses:this._getStyles("tooltipClasses"),persistTooltip:this.props.persistToolTip,uuid:this.state.uuid,ylkData:this.state.ylk};return r.default.createElement("div",{className:this._getStyles("likeClasses"),key:"like"},r.default.createElement(u.default,n))},renderShareButtonGroup:function(){var t=this.config,e=t.buttonSize||a.default.size.LARGE,n=this.langStore.getStrings("tdv2-applet-content-canvas"),o=!1!==t.isTouchDevice,s={buttonShape:a.default.shape.SQUARE,buttonWidth:this._getStyles("buttonWidth"),iconRendererClassName:this._getStyles("iconRendererClasses"),iconSize:this.props.iconSize,maxSquareWidth:this.props.maxSquareWidth,minSquareWidth:this.props.minSquareWidth,persistToolTip:this.props.persistToolTip,persistTooltipClasses:(0,f.default)(this._getStyles("shareButtonTooltipClasses"),{"D(n)":this.props.hideText,"End(9px) D(n)--modalFloatingCloseBtn":this.props.persistToolTip}),showShareInfoOnHover:!o,touchDevice:o,useButtonColorForBackground:this.props.useButtonColorForBackground};return t.enableRoundShareButtons&&(s={buttonShape:a.default.shape.ROUND,buttonSpacingPixelsSmall:this.props.buttonSpacingPixels,iconSize:this.props.iconSize,maxSquareWidth:this.props.maxSquareWidth,roundButtonDiameter:this.props.roundButtonDiameter,showShareInfoOnHover:!1,touchDevice:o,useButtonColorForBackground:this.props.useButtonColorForBackground,useHoverColor:t.enableHoverColor,enableHoverColorTransition:t.enableHoverColorTransition}),r.default.createElement(l.default,Object.assign({},s,{alignLeft:this.props.alignLeft,buttonsToShow:this.state.buttons,buttonSize:e,buttonOrientation:this.props.orientation,className:this._getStyles("outerContainerClasses"),key:"share",messages:n,metaData:this.state.shareMeta,sharingConfig:{device:this._getDevice(),shouldUseBrowserUrl:this.props.shouldUseBrowserUrl,site:this.state.site,twitterId:this.state.twitterId},showTooltipAtBottom:this.props.showTooltipAtBottom,webshare:t.webshare,ylkData:this.state.ylk}))}},t.exports=e.default},2441:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=(o(n(0)),o(n(1))),l=o(n(2)),d=function(t){function e(t){return s(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return r(e,t),a(e,[{key:"render",value:function(){var t=this.props,e=t.className,n=t.items,o=t.index,s=n&&n[o];if(!s)return null;var i=s.comment,r=(0,l.default)(s,["userProfile","nickName"]);return r=r?r+": ":null,u.default.createElement("p",{className:e},u.default.createElement("span",{className:"Fw(b)"},r),u.default.createElement("span",null,i))}}]),e}(u.default.Component);d.defaultProps={index:0,items:[]},d.displayName="CommentSlider",e.default=d,t.exports=e.default},2442:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(0)),i=o(n(1)),r=o(n(4)),a=o(n(2));e.default=(0,r.default)({autobind:!1,displayName:"ProfileImageSlider",propTypes:{classNames:s.default.string,iconSize:s.default.number,index:s.default.number,items:s.default.array.isRequired},getDefaultProps:function(){return{classNames:"Pos(r) H(25px) W(32px)",iconSize:25,index:0,items:[]}},getItemStyle:function(t){return{left:6*t-4,transform:"scale("+(1-.12*(2-t))+")"}},getLoopIndex:function(t,e,n){var o=(t+e)%n;return o<0?o+n:o},getItems:function(){var t,e=this.props.index,o=(0,a.default)(this.props,["items","length"],0),s=this.props.items,r=[];for(t=0;t<3;t++){var u=this.getLoopIndex(e,2-t,o),l=this.getItemStyle(t);r.push(i.default.createElement("li",{key:"jtd-item-"+u,className:"Pos(a)",style:l},i.default.createElement(n(74).Img,{checkPosition:!1,className:"Bdrs(50%) Bdw(2px) Bdc(#fff) Bds(s) Bxz(bb)",height:this.props.iconSize,width:this.props.iconSize,url:s[u]})))}return r},render:function(){var t=this.props;if(0===t.items.length)return null;var e=this.getItems();return i.default.createElement("ul",{className:t.classNames},e)}}),t.exports=e.default},3169:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(1)),i=o(n(4)),r=o(n(5)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(22)),u=o(n(3170)),l=o(n(12)),d=o(n(2066)),c=o(n(34));e.default=(0,i.default)({displayName:"CanvasStickyShareButtons",autobind:!1,mixins:[l.default,d.default],statics:{componentConfig:{bundleName:"tdv2-applet-content-canvas",name:"componentStickyShareButtons"}},shouldComponentUpdate:function(t,e){return e.uuid!==this.state.uuid||e.status!==this.state.status||e.winHeight!==this.state.winHeight||e.isCurrentRenderTarget!==this.state.isCurrentRenderTarget},shouldFreeze:function(){return!this._isCurrentRenderTarget()},componentWillMount:function(){this.shouldFreeze=this.shouldFreeze.bind(this),this.onStateChange=this.onStateChange.bind(this)},componentDidMount:function(){if("undefined"!=typeof window){this.setState({winHeight:window.innerHeight||document.documentElement.clientHeight})}this.subscriber=(0,c.default)("resize",this.handleResize.bind(this),{enableResizeInfo:!0})},componentWillUnmount:function(){this.subscriber&&this.subscriber.unsubscribe()},handleResize:function(t,e){if(!this.shouldFreeze()){this.setState({winHeight:e.resize.height})}},onStateChange:function(t){this.setState({status:t.status,bottom:t.bottom})},renderCommentsButton:function(){if(!this.props.enableCommentsButton||this.state.isLcp&&!this.props.enableCommentsButtonOffnet)return null;var t=this.state.uuid,e=this.state.status,n=a.STATUS_FIXED_NEAR_BOTTOM===e||a.STATUS_RELEASED===e,o=t?"article[data-uuid='"+t+"']":null,i=this.state.winHeight,r=this.state.bottom,l=40,d=a.DOCKPOS_BOTTOM;i&&r&&(i-r<40+a.STATUS_NEAR_RANGE&&(n=!0),i-r<40&&(d=a.DOCKPOS_TOP,l=r-40));var c={buttonSize:this.props.roundButtonDiameter,classNames:"",containerClassNames:"Mt(-40px)",dockPos:d,enableDockedCommentsFlyout:this.config.enableDockedCommentsFlyout,fixedY:l,iconClasses:this._getStyles("commentsIconClasses"),iconSize:this.props.iconSize,key:"comments",scrollMarginTop:this.props.commentScrollMarginTop,scrollTargetClass:"canvas-bottom-anchor-"+t,hideCommentCount:n,useHoverColor:this.config.enableHoverColor,uuid:t,bottomBoundarySelector:o,shouldFreeze:this.shouldFreeze};return s.default.createElement(u.default,c)},render:function(){var t=this.state.uuid,e=t?"article[data-uuid='"+t+"']":null,o=(0,r.default)("canvas-share-buttons StretchedBox",this.props.className);return this._isCurrentRenderTarget()?s.default.createElement("div",{className:o},s.default.createElement(n(1214).DockedContainer,{bottomBoundarySelector:e,dockPos:a.DOCKPOS_TOP,fixedYSelector:".YDC-UH",shouldFreeze:this.shouldFreeze,onStateChange:this.onStateChange},s.default.createElement("div",{className:"Pb(48px)"},this.renderLikeButton(),this.renderShareButtonGroup())),this.renderCommentsButton()):null}}),t.exports=e.default},3170:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(1)),i=o(n(4)),r=o(n(517)),a=o(n(3171)),u=o(n(287)),l=o(n(5)),d=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(22)),c=o(n(1665)),f=o(n(12)),p=o(n(1865)),h=o(n(3172)),m=o(n(0)),g=o(n(9)),C=(0,i.default)({displayName:"DockedCommentsButton",autobind:!1,mixins:[f.default],contextTypes:{i13n:m.default.object},statics:{storeListeners:[u.default]},propTypes:{backgroundColors:m.default.object,bottomBoundary:m.default.string,buttonSize:m.default.number,classNames:m.default.string,containerClassNames:m.default.string,dockPos:m.default.string,fixedY:m.default.number,hideCommentCount:m.default.bool,iconClasses:m.default.string,iconColor:m.default.string,iconSize:m.default.number,scrollMarginTop:m.default.number,scrollTargetClass:m.default.string.isRequired,shouldFreeze:m.default.func,uuid:m.default.string.isRequired},getInitialState:function(){this.canvassStore=this.getStore(u.default),this.currentNode=null,this.i13nModel={action:"click",itc:1,sec:"hl-viewer",slk:"comments",outcm:"open"};var t=this._getState(this.props);return t.hovered=!1,t},getDefaultProps:function(){return{backgroundColors:{initial:"#5601C0",hovered:"#320071"},bottomBoundary:null,buttonSize:40,classNames:"",containerClassNames:"",dockPos:d.DOCKPOS_BOTTOM,fixedY:40,hideCommentCount:!1,iconClasses:"",iconColor:"#fff",iconSize:20,scrollMarginTop:-150,shouldFreeze:function(){return!1}}},onChange:function(){this.currentNode=g.default.findDOMNode(this.refs.dockedCommentsBtn),this.setState(this._getState(this.props))},componentWillMount:function(){this._commentsClickButtonHandler=this._commentsClickHandler.bind(this,"button"),this._commentsClickFlyoutHandler=this._commentsClickHandler.bind(this,"flyout"),this._onHover=this._onHover.bind(this),this.onChange=this.onChange.bind(this),this.onCloseBtnClick=this.onCloseBtnClick.bind(this),this.onStateChange=this.onStateChange.bind(this)},shouldComponentUpdate:function(t,e){return t.uuid!==this.props.uuid||t.fixedY!==this.props.fixedY||t.dockPos!==this.props.dockPos||t.hideCommentCount!==this.props.hideCommentCount||e.count!==this.state.count||e.hovered!==this.state.hovered||e.showFlyout!==this.state.showFlyout||e.status!==this.state.status},componentWillReceiveProps:function(t){t.uuid!==this.props.uuid&&this.setState(this._getState(t))},_getState:function(t){var e=this.canvassStore.getCommentsState("canvass-"+t.uuid),o=this.getCommentCount(e);if(e)return{count:o,countString:(0,n(115).getCommentString)(o),messageList:this.getMessageList(e),showFlyout:!0,url:this.getContextUrl(e)}},getCommentCount:function(t){return t&&(0,n(11).get)(t,"count")||0},getContextUrl:function(t){return t&&(0,n(11).get)(t,"contextUrl")||""},getMessageList:function(t){return t&&(0,n(11).toJS)((0,n(11).get)(t,"messageList"))||[]},_getScrollTop:function(){return document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop},_commentsClickHandler:function(t){var e=this;if("flyout"===t&&e.context.i13n.executeEvent("beacon",{beaconType:"beaconClick",arguments:["hl-viewer","comments",null,{elm:"cmmt",itc:1,outcm:"open"}]}),e.props.scrollTargetClass){var n=e.props.uuid,o=document.getElementsByClassName(e.props.scrollTargetClass)||[];if(o[0]){var s=o[0].getBoundingClientRect().bottom,i=e._getScrollTop()+s+e.props.scrollMarginTop;(0,r.default)(i,null,null,function(){var t=document.getElementById("canvass-"+n);t&&t.focus({preventScroll:!0}),e.executeAction(c.default,{context:n,instanceId:"canvass-"+n,isExpanded:!0})})}}},_onHover:function(){this.setState({hovered:!this.state.hovered})},onStateChange:function(t){this.setState({status:t.status})},onCloseBtnClick:function(t){t&&t.stopPropagation(),this.context.i13n.executeEvent("beacon",{beaconType:"beaconClick",arguments:["hl-viewer","comment_close",null,{elm:"close",itc:1,outcm:"close"}]}),this.setState({showFlyout:!1})},_getFlyoutProps:function(){var t=this.state.messageList;return t&&0===t.length?null:{autoRotation:!0,i13nModel:this.i13nModel,messageList:t,onClick:this._commentsClickFlyoutHandler,onCloseBtnClick:this.onCloseBtnClick,url:this.state.url,uuid:this.props.uuid}},renderCommentCount:function(){var t=this.state.count;if(!t)return null;var e=this.state.status,n=" Op(1)";return e&&!this.props.hideCommentCount&&d.STATUS_ORIGINAL!==e&&d.STATUS_ORIGINAL_DISABLED!==e&&d.STATUS_FIXED_NEAR_TOP!==e||(n=" Op(0)"),s.default.createElement("div",{className:"Pos(a) T(-20px) Start(0) End(0) C($c-fuji-purple-1-c) Py(3px) Fw(b) Trsdu(.2s) Trsp(opacity)"+n},t)},renderCommentFlyout:function(){var t=this._getFlyoutProps();return t&&this.currentNode?s.default.createElement(p.default,{align:"right",Component:a.default,componentProps:t,fixedToParent:!0,flyoutWidth:682,flyoutHeight:71,parentNode:this.currentNode,relativeToParent:!0,paddingLeft:18,triangleFillColor:"#f7f8ff"}):null},render:function(){var t=this.props,e=this.state;if(!t.uuid)return null;var o=t.iconSize,i=(0,l.default)("H(100%)",t.iconClasses),r=t.backgroundColors,a=parseInt(t.buttonSize,10)+"px",u=e.status,c={"aria-label":t.intl.formatMessage({id:"COMMENT",defaultMessage:"Comment"}),onClick:this._commentsClickButtonHandler,onMouseEnter:this._onHover,onMouseLeave:this._onHover,i13nModel:Object.assign({},this.i13nModel,{elm:"btn"}),width:a,className:"canvas-modal-comments-button Cur(p) P(0) O(n) Bdrs(50%) Trs(hoverColorTransition)",style:{width:a,height:a,backgroundColor:this.state.hovered?r.hovered:r.initial}},f="Trsdu(.2s) Trsp(scale)";f+=u!==d.STATUS_ORIGINAL?" Scale(1)":" Scale(0)";var p=t.enableDockedCommentsFlyout&&e.showFlyout&&2===e.status;return s.default.createElement(n(1214).DockedContainer,{bottomBoundarySelector:t.bottomBoundarySelector,className:t.containerClassNames,dockPos:t.dockPos,fixedY:t.fixedY,shouldFreeze:t.shouldFreeze,onStateChange:this.onStateChange,innerZ:3},s.default.createElement("div",{ref:"dockedCommentsBtn",style:{width:a,height:a},className:"Ta(c)"},s.default.createElement("div",{className:f},this.renderCommentCount(),s.default.createElement(n(14).I13nButton,c,s.default.createElement(n(19).Icon,{asset:h.default,className:i,color:t.iconColor,height:o,width:o})))),p?this.renderCommentFlyout():null)}});e.default=(0,n(31).injectIntl)(C),t.exports=e.default},3171:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(1)),i=o(n(4)),r=o(n(0)),a=o(n(88)),u=o(n(2441)),l=o(n(12)),d=o(n(2)),c=o(n(2442)),f=o(n(1590)),p="undefined"!=typeof window?window:null;e.default=(0,i.default)({displayName:"CanvasCommentFlyout",autobind:!1,mixins:[l.default],propTypes:{autoRotation:r.default.bool,messageList:r.default.array.isRequired,onClick:r.default.func,onCloseBtnClick:r.default.func,uuid:r.default.string},contextTypes:{i13n:r.default.object},getDefaultProps:function(){return{autoRotation:!1,messageList:[],rotationInterval:15e3}},getInitialState:function(){return this.timer=null,this._getState()},componentDidMount:function(){this.props.autoRotation&&this._enableAutoRotation(),this._fireLinkView()},componentWillReceiveProps:function(t){t.autoRotation?this._enableAutoRotation():this._disableAutoRotation(),t.url!==this.props.url&&this.setState(this._getState())},componentWillUnmount:function(){this._disableAutoRotation()},shouldComponentUpdate:function(t,e){return t.url!==this.props.url||e.commentIndex!==this.state.commentIndex},_enableAutoRotation:function(){p&&(this._disableAutoRotation(),this.timer=setInterval(function(){this._step(1)}.bind(this),this.props.rotationInterval))},_disableAutoRotation:function(){p&&this.timer&&clearInterval(this.timer)},_fireLinkView:function(t){this.context.i13n.executeEvent("beacon",{beaconType:"beaconLinkViews",arguments:[[{sec:"hl-viewer",_links:[{elm:"cmmt",outcm:"open",slk:"comments",subsec:"flyout"}]}]]},t)},_getState:function(){return{commentIndex:0}},_step:function(t){var e=(0,d.default)(this.props,["messageList","length"],0);this.setState({commentIndex:f.default.getLoopIndex(this.state.commentIndex,t,e)})},_processCommentsData:function(){return(this.props.messageList||[]).map(function(t){return{comment:(0,d.default)(t,["details","userText"],""),userProfile:{nickName:(0,d.default)(t,["meta","author","nickname"],"")}}})},render:function(){var t=this.props,e=this.state,o=e.commentIndex,i=t.messageList;if(i&&0===i.length)return null;var r=this._processCommentsData(),l=i.map(function(t){return(0,d.default)(t,["meta","author","image","url"],"")});return s.default.createElement("div",{className:"Pos(r) Cur(p) Ai(c) D(f) W(100%) Bxsh(commentFlyoutShadow) Bg($c-fuji-grey-a) Bdrs(3px) Bdw(1px) Bds(s) Bdc($c-fuji-grey-e)",onClick:t.onClick},s.default.createElement("div",{className:"Fl(start) Pos(r) Pend(5px) Pstart(14px) Py(16px)"},s.default.createElement(c.default,{classNames:"Pos(r) H(33px) W(44px)",iconSize:33,index:o,items:l})),s.default.createElement("div",{className:"Flxs(1) Pos(r) Pend(40px) Py(16px)"},s.default.createElement(u.default,{className:"C(#000) Fz(13px) Lh(17px) LineClamp(2,34px)",items:r,index:o})),s.default.createElement("div",{className:"Pt(2px) Pos(a) End(0) T(0) Pend(6px)",onClick:t.onCloseBtnClick},s.default.createElement(n(19).Icon,{className:"close-btn",asset:a.default,height:14,color:"#787d82"})))}}),t.exports=e.default},3172:function(t,e){if(void 0===n)var n={};n["comments-fill"]={name:"comments-fill",height:16,width:16,path:"M3.396.667h9.228c1.507 0 2.73 1.194 2.73 2.667V10c0 1.474-1.223 2.668-2.73 2.668H4.556l-2.77 2.487c-.124.117-.288.18-.453.18-.09 0-.18-.02-.266-.056-.243-.107-.4-.347-.4-.612V3.335C.666 1.862 1.888.668 3.394.668zm7.958 4H4.687c-.368 0-.667.298-.667.667s.3.667.667.667h6.667c.37 0 .667-.298.667-.666s-.297-.667-.666-.667zM4.688 7.333c-.368 0-.667.298-.667.667s.3.667.668.667h6.667c.37 0 .667-.3.667-.667s-.298-.667-.667-.667H4.688z"},void 0!==t&&t.exports&&(t.exports=n["comments-fill"])}});