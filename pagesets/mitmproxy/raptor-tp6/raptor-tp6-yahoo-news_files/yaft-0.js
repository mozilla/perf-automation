"undefined"!=typeof window&&!function(a,b){"use strict";function c(a){var b,d={};for(b in a)"object"==typeof a[b]&&null!==a[b]?d[b]=c(a[b]):d[b]=a[b];return d}function d(a){var c,d,e,f,g,h=navigator.userAgent,i=navigator.appVersion,j=E.timing,k=j.navigationStart,l=new Date(k),m="200",n="OK",o=-1,p=0,q=0,r=0,s=0,t=-1,u=0,v=0;for(f={log:{version:"1.2",creator:{name:"YAFT",version:"0.1.0"},browser:{name:h,version:i},pages:[{startedDateTime:l.toISOString(),id:"Page_1",title:b.location.href,pageTimings:{onContentLoad:j.domInteractive-k,onLoad:j.loadEventStart-k}}],entries:[],comment:""}},g=0;g<a.length;g+=1)c=a[g],d=new Date(Math.round(k+c.start)),p=Math.round(c.dnsDuration),q=Math.round(c.tcpDuration),t=Math.round(c.sslDuration),r=Math.round(c.responseStart-c.requestStart),s=Math.round(c.responseDuration),u=Math.round(c.duration)-p-q-r-s,v=Math.round(c.duration),0>u&&(v-=u,u=0),e={pageref:"Page_1",startedDateTime:d.toISOString(),time:v,request:{method:"GET",url:c.url,httpVersion:"HTTP/1.1",cookies:[],headers:[],queryString:[],headersSize:-1,bodySize:-1},response:{status:m,statusText:n,httpVersion:"HTTP/1.0",cookies:[],headers:[],content:{size:o,compression:0,mimeType:""},redirectURL:"",headersSize:-1,bodySize:o},cache:{},timings:{blocked:-1,dns:p,connect:q,send:r,ssl:t,wait:u,receive:s}},f.log.entries.push(e);return f}function e(){var a,b,c,d=[],e=0,h=[];for(d.push(g()),h=E.getEntriesByType("resource"),a=0;a<h.length;a+=1)"document"!==h[a].name&&d.push(f(h[a]));if(c=document.getElementsByTagName("iframe"),c&&c.length){for(b=0;b<c.length;b+=1)try{for(h=c[b].contentWindow.performance.getEntriesByType("resource"),e=c[b].contentWindow.performance.timing.navigationStart-E.timing.navigationStart,a=0;a<h.length;a+=1)"document"!==h[a].name&&d.push(f(h[a],e))}catch(i){}d.sort(function(a,b){return a.start-b.start})}return d}function f(a,b){return b&&b>0||(b=0),{url:a.name,start:a.startTime+b,duration:a.duration,durationFromNStart:a.duration>0?a.duration+a.startTime+b:a.startTime+b,redirectStart:a.redirectStart+b,redirectDuration:a.redirectEnd-a.redirectStart,appCacheStart:0,appCacheDuration:0,dnsStart:a.domainLookupStart+b,dnsDuration:a.domainLookupEnd-a.domainLookupStart,tcpStart:a.connectStart+b,tcpDuration:a.connectEnd-a.connectStart,sslStart:a.secureConnectionStart>0?a.secureConnectionStart-a.connectStart:0,sslDuration:a.secureConnectionStart>0?a.connectEnd-a.secureConnectionStart:-1,requestStart:a.requestStart+b,requestDuration:a.responseStart-a.requestStart,responseStart:a.responseStart+b,responseDuration:0===a.responseStart?0:a.responseEnd-a.responseStart}}function g(){var a=E.timing;return{url:b.location.href,start:0,duration:a.responseEnd-a.navigationStart,durationFromNStart:a.responseEnd-a.navigationStart,redirectStart:0===a.redirectStart?0:a.redirectStart-a.navigationStart,redirectDuration:a.redirectEnd-a.redirectStart,appCacheStart:0,appCacheDuration:0,dnsStart:a.domainLookupStart-a.navigationStart,dnsDuration:a.domainLookupEnd-a.domainLookupStart,tcpStart:a.connectStart-a.navigationStart,tcpDuration:a.connectEnd-a.connectStart,sslStart:a.secureConnectionStart>0?a.secureConnectionStart-a.connectStart:0,sslDuration:a.secureConnectionStart>0?a.connectEnd-a.secureConnectionStart:-1,requestStart:a.requestStart-a.navigationStart,requestDuration:a.responseStart-a.requestStart,responseStart:a.responseStart-a.navigationStart,responseDuration:a.responseEnd-a.responseStart}}function h(){return{win:a,doc:b,docElem:P,viewportWidth:P.clientWidth<a.innerWidth?a.innerWidth:P.clientWidth,viewportHeight:P.clientHeight<a.innerHeight?a.innerHeight:P.clientHeight,getScrollXY:function(){return{x:a.scrollX||a.pageXOffset,y:a.scrollY||a.pageYOffset}},getViewportArea:function(){return this.viewportWidth*this.viewportHeight},getElementBounds:function(a){var b,d=a,e=this.getScrollXY();return b=c(d.getBoundingClientRect()),b.top=b.top+e.y,b.bottom=b.bottom+e.y,b.left=b.left+e.x,b.right=b.right+e.x,b},isInViewport:function(a){var b=this.getElementBounds(a);return b.top<this.viewportHeight&&b.left<this.viewportWidth&&b.bottom>=0&&b.right>=0&&this.isVisible(a)},isVisible:function(b){var c=!0,d=b;if(c=c&&d.offsetWidth>0&&d.offsetHeight>0)for(;"BODY"!==d.tagName&&c;)c=c&&"hidden"!==a.getComputedStyle(d).visibility,d=d.parentElement;return c},getElementCoverage:function(a){var b,c,d=this.getElementBounds(a);return b=d.right<0?0:d.right>this.viewportWidth?d.left>=0?this.viewportWidth-d.left:this.viewportWidth:d.left<0&&d.right>0?d.right:d.width,c=d.bottom<0?0:d.bottom>this.viewportHeight?d.top>=0?this.viewportHeight-d.top:this.viewportHeight:d.top<0&&d.bottom>0?d.bottom:d.height,b*c},getElementPercentage:function(a){var b=this.getElementCoverage(a),c=this.getViewportArea(),d=100*b/c;return Math.round(d)>0?d:0}}}function i(a,c,d){var e,f,g,h,i,j,k="",l=!1,m=[],n=0;for(a=a||[],c&&!d?m=c:!c&&d?m=d:c&&d&&(m=c.concat(d)),n=m&&m.length?m.length:0,e=0,j=a.length;j>e;e+=1)for(g=a[e],h=b.querySelectorAll(YAFT.getModuleSelector(g)),i=h.length,f=i-1;f>=0;f--)k=YAFT.getModuleName(h[f]),l=!1,-1!==m.indexOf(k)&&(l=!0),l||W[k]||(h[f].modName=k,W[k]=h[f]);return W}function j(a,b){var c=a.modName;Y[c]||(Y[c]=n(a,b))}function k(a,b){var c,d;for(d in a)a.hasOwnProperty(d)&&(Y[d]||(c=n(a[d]),b?c.isAft2Module&&(Y[d]=c):Y[d]=c));return Y}function l(){return Q.useNativeStartRender?R?R:YAFT.getStartRenderTime():K?E.timing.domContentLoadedEventStart-N:0}function m(a,b){for(var c=!1;b.parentNode;){if(b.parentNode.id&&-1!==a.indexOf(b.parentNode.id)){c=!0;break}b=b.parentNode}return c}function n(a,b){var c,d,e,g,h=!1,i=m(Q.modulesAft2Container,a),j=Q.customReportModules&&-1!==Q.customReportModules.indexOf(a.modName),k=[],n=E.now(),o=i?n-Z:n,p=Z?aa:l(),q=j?o:p,r=a.querySelectorAll("div, img, a, video, span, ul, li, figure"),s=r.length;if(b)h=!0,p=b.modStart?b.modStart:p,q=b.modEnd?b.modEnd:q,Z&&(p>Z?p-=Z:p=0,q>Z?q-=Z:q=0);else if(Z>0&&!i)p=0,q=0;else if(j)h=!0;else{if(e=YAFT.getElemResourceUrl(a),e&&(g=E.getEntriesByName(e),g&&g.length&&g.length>0&&F.isInViewport(a)&&k.push(f(g[0]))),r&&s>0)for(c=0;s>c;c+=1)d=r[c],e=YAFT.getElemResourceUrl(d),e&&(g=E.getEntriesByName(e),g&&g.length&&g.length>0&&F.isInViewport(d)&&k.push(f(g[0])));if(s=k.length,s>0)for(c=0;s>c;c+=1)Z>0&&i&&(k[c].start-=Z,k[c].durationFromNStart-=Z,k[c].start<=0&&(k[c].start=p),k[c].durationFromNStart<=0&&(k[c].durationFromNStart=q)),k[c].start>p&&(p=k[c].start),k[c].durationFromNStart>q&&(q=k[c].durationFromNStart)}return{isCustom:h,isAft2Module:i,start:p,loadTime:q,name:a.modName,resources:k,inViewPort:F.isInViewport(a),coverageArea:F.getElementCoverage(a),coveragePercentage:F.getElementPercentage(a)}}function o(a){var b,c=0,d=0;for(b in a)a.hasOwnProperty(b)&&(c=a[b].coveragePercentage,a[b].inViewPort&&Math.round(c)>0&&(d+=c));return d}function p(a){var b,c=a.length;for(b=0;c>b;b+=1)if(Q.useNormalizeCoverage){if(Math.round(a[b])===Math.round(T))return 100*b}else if(Math.round(a[b])===Math.round(S))return 100*b;return 0}function q(a){var b,c,d=0,e=E.now()-Z,f=Math.floor(e/100),g=new Array(f),h=0;for(b=0;f>b;b+=1)g[b]=0;b=0;for(c in a)a.hasOwnProperty(c)&&a[c].inViewPort&&Math.round(a[c].coveragePercentage)>0&&(Q.useNormalizeCoverage&&(a[c].normCoveragePercentage=a[c].coveragePercentage/S*100,h+=a[c].normCoveragePercentage),a[c].loadTime>=0&&(b=Math.round(a[c].loadTime/100),g[b]+=Q.useNormalizeCoverage?a[c].normCoveragePercentage:a[c].coveragePercentage));for(d+=Q.useNormalizeCoverage?h-g[0]:S-g[0],b=1;f>b;b+=1)g[b]=g[b-1]+g[b],d+=Q.useNormalizeCoverage?h-g[b]:S-g[b];return{aft:d,aftIntervals:g,normTotalCoveragePercentage:h}}function r(){var a=V.slice(0);return a.sort(function(a,b){return b.duration-a.duration}),a}function s(a){var b={},c=0,d=0,e=YAFT.getPageLoadTime(),f=0,g=0;for(b.count=a.length,c=0;c<b.count;c+=1)a[c].start<=e&&(f+=1),a[c].duration<=0&&(d+=1,a[c].start<=e&&(g+=1));return b.cached=d,b.nonCached=b.count-d,b.onloadCount=f,b.onloadCached=g,b.onloadNonCached=f-g,b}function t(a,b){var c,d,e,f;return c=b.map(function(b){var c=b-a,d=c*c;return d}),d=c.reduce(function(a,b){return a+b},0),e=d/c.length,f=Math.sqrt(e)}function u(){var a,b,c,d=ea.length,e={median:NaN,max:NaN,min:NaN,avg:NaN,stdev:NaN};return 0===d?e:(b=(ea[d-1]-ea[0])/(d-1),e.avg=1e3/b,a=ea.map(function(a,b){return 0===b?NaN:a-ea[b-1]}),a.shift(),e.stdev=t(b,a),a.sort(function(a,b){return a-b}),e.max=1e3/a[0],e.min=1e3/a[a.length-1],c=Math.floor(a.length/2),a.length%2?e.median=1e3/a[c]:e.median=1e3/((a[c-1]+a[c])/2),e)}function v(){ea.push(E.now()),da&&ea.length<300&&(H=a.requestAnimationFrame(v))}function w(b){return L?(da=!1,H&&a.cancelAnimationFrame(H),G=b,ea.length=0,da=!0,void(H=a.requestAnimationFrame(v))):!1}function x(b,c){var d;return da=!1,L?(H&&a.cancelAnimationFrame(H),G!==b?(c&&c("FPS stop action cannot be different than start action"),!1):(d=u(),d.action=b,d.avg?(c&&c(null,d),YAFT.logToConsole(d),d):(c&&c("FPS is not available"),!1))):(c&&c("FPS is not available for this browser"),!1)}function y(){if(W={},Y={},$=0,!K||!J)return!1;M===!0&&Q.canShowVisualReport&&a.YAFT_REPORT&&a.YAFT_REPORT.removeReport&&(a.YAFT_REPORT.removeExtras(),a.YAFT_REPORT.removeReport()),ba&&clearTimeout(ba),ca&&clearTimeout(ca);try{E.clearResourceTimings?E.clearResourceTimings():E.webkitClearResourceTimings&&E.webkitClearResourceTimings()}catch(b){}Z=E.now(),_=Z+N}function z(){return K&&J?void(0===$&&($=E.now())):!1}function A(b){var c={},f={},g={},j={},l=0;return K&&J?($||($=E.now()),aa=$-Z,void(Q.maxWaitTime&&Q.maxWaitTime>0&&(ca=setTimeout(function(){F||(F=h()),V=e(),l=YAFT.getDomElementsCount(),i(Q.modules,Q.modulesExclude,Q.modulesAft2Container),k(W,Q.includeOnlyAft2),g=YAFT.getFinalModulesReport(),S=o(g),f=q(g),T=f.normTotalCoveragePercentage,X=p(f.aftIntervals),Q.generateHAR&&(j=d(V)),c={aft:f.aft,startRender:aa,event:"aft2",modulesReport:g,totalCoveragePercentage:S,normTotalCoveragePercentage:T,domElementsCount:l,resources:V,har:j,visuallyComplete:X},b&&b(c),YAFT.data.push(c),M===!0&&Q.canShowVisualReport&&a.YAFT_REPORT&&a.YAFT_REPORT.drawReport&&a.YAFT_REPORT.drawReport(c,f.aftIntervals)},Q.maxWaitTime)))):(b(null,"Nav or resource timing or both are not available or YAFT is not initialized"),!1)}function B(b,c){var f,g={},j={},l=YAFT.getPageLoadTime(),m=YAFT.getDomContentLoaded(),n=YAFT.getDomElementsCount(),t=YAFT.getTTFB(),u=YAFT.getDomInteractive(),v={},w={},x={},y=[],z=[];if(R=YAFT.getStartRenderTime(),V=e(),!(V&&V.length&&V.length>0))return void c(null,"No timings available");if(Q.plugins)for(f=0;f<Q.plugins.length;f+=1)window["yaft_"+Q.plugins[f].name]&&window["yaft_"+Q.plugins[f].name].execute?Q.plugins[f].isPre?(y.push(Q.plugins[f]),YAFT.logToConsole("YAFT plugin "+Q.plugins[f].name+" will be executed before the callback")):(z.push(Q.plugins[f]),YAFT.logToConsole("YAFT plugin "+Q.plugins[f].name+" will be executed after the callback")):YAFT.logToConsole("YAFT plugin "+Q.plugins[f].name+" not found or it does not have execute method");for(F||(F=h()),i(Q.modules,Q.modulesExclude,Q.modulesAft2Container),k(W),v=YAFT.getFinalModulesReport(),S=o(v),j=q(v),T=j.normTotalCoveragePercentage,U=r(),x=s(U),X=p(j.aftIntervals),Q.generateHAR&&(w=d(V)),g={aft:j.aft,pageLoadTime:l,startRender:R,domInteractive:u,domContentLoaded:m,ttfb:t,event:b,modulesReport:v,totalCoveragePercentage:S,normTotalCoveragePercentage:T,domElementsCount:n,resources:V,har:w,costlyResources:U,httpRequests:x,visuallyComplete:X},f=0;f<y.length;f+=1)try{window["yaft_"+y[f].name].execute(y[f].config,g)}catch(A){YAFT.logToConsole("YAFT plugin "+y[f].name+" failed to execute"),YAFT.logToConsole(A)}for(c&&(YAFT.logToConsole(g),YAFT.logToConsole(j.aftIntervals),c(g)),YAFT.data.push(g),f=0;f<z.length;f+=1)try{window["yaft_"+z[f].name].execute(z[f].config,g)}catch(A){YAFT.logToConsole("YAFT plugin "+z[f].name+" failed to execute"),YAFT.logToConsole(A)}M===!0&&Q.canShowVisualReport&&a.YAFT_REPORT&&a.YAFT_REPORT.drawReport&&a.YAFT_REPORT.drawReport(g,j.aftIntervals)}function C(a,b){return!O&&J?(O=!0,K?void(Q.maxWaitTime&&Q.maxWaitTime>0?ba=setTimeout(function(){B(a,b)},Q.maxWaitTime):B(a,b)):(b(null,"Nav or resource timing or both are not available"),!1)):void 0}function D(){return a.performance||a.webkitPerformance||a.msPerformance||a.mozPerformance||a.Performance}if(void 0===a.YAFT){var E,F,G,H,I="0.3.10",J=!1,K=!1,L=!1,M=!1,N=(new Date).getTime(),O=!1,P=b.documentElement,Q={useNormalizeCoverage:!0,canShowVisualReport:!0,useNativeStartRender:!1,generateHAR:!1,maxWaitTime:3e3,modules:[],modulesExclude:[],modulesAft2Container:[],customReportModules:[],includeOnlyAft2:!1,plugins:[],whiteListedContainerElements:["div","section","ul","ol","li","header"],customStartRender:!1},R=0,S=0,T=0,U=[],V={},W={},X=0,Y={},Z=0,$=0,_=0,aa=0,ba=0,ca=0,da=!1,ea=[];E=D(),E&&E.timing&&(N=E.timing.navigationStart,E.now=E.now||E.webkitNow||E.msNow||E.mozNow||void 0,E.now&&(void 0===E.getEntriesByType&&void 0===E.webkitGetEntriesByType||void 0===E.getEntriesByName&&void 0===E.webkitGetEntriesByName||(K=!0),a.requestAnimationFrame&&a.cancelAnimationFrame&&(L=!0))),a.YAFT={data:[],triggerPerf:C,triggerCustomTiming:function(a,c,d){if(!K)return!1;var e,f,g;YAFT.isInitialized()&&(F||(F=h()),e=b.querySelectorAll(YAFT.getModuleSelector(a)),e&&e.length>0&&(f=e[0],g=YAFT.getModuleName(f),f.modName=g,W[g]=f,j(f,{modStart:c,modEnd:d})))},getFinalModulesReport:function(){return Y},reset:function(){J=!0,O=!1,W=[],Y={}},perfExists:function(){return K},isInitialized:function(){return J},getConfig:function(){return Q},updateConfig:function(a){var b;for(b in a)Q.hasOwnProperty(b)&&a.hasOwnProperty(b)&&"undefined"!==Q[b]&&(Q[b]=a[b])},getPerformance:D,init:function(b,c){return this.reset(),K?(this.getQueryStrings().showaft&&(M=!0),this.updateConfig(b),void(E.timing.loadEventStart>E.timing.navigationStart?YAFT.triggerPerf("deferred",c):a.addEventListener?(a.addEventListener("load",function(){YAFT.triggerPerf("load",c)},!1),a.addEventListener("unload",function(){YAFT.triggerPerf("unload",c)},!1)):a.attachEvent&&(a.attachEvent("onload",function(){YAFT.triggerPerf("load",c)}),a.attachEvent("onunload",function(){YAFT.triggerPerf("unload",c)})))):(c(null,"Nav or resource timing or both are not available"),!1)},AFT2:{start:y,setAFT2StartRender:z,end:A},FPS:{start:w,stop:x},getDomElementsCount:function(){return b.getElementsByTagName("*").length},getTTFB:function(){return K?E.timing.responseStart-N:0},getPageLoadTime:function(){return K?E.timing.loadEventStart-N:0},getDomContentLoaded:function(){return K?E.timing.domContentLoadedEventStart-N:0},getStartRenderTime:function(){var b,c,d,e;return K?Q.customStartRender&&"function"==typeof Q.customStartRender?Q.customStartRender():(b=this.getDomContentLoaded(),"msFirstPaint"in a.performance.timing?c=a.performance.timing.msFirstPaint-N:"chrome"in a&&"loadTimes"in a.chrome&&a.chrome.loadTimes&&(d=a.chrome.loadTimes(),"firstPaintTime"in d&&d.firstPaintTime>0&&(e=d.startLoadTime,"requestTime"in d&&d.requestTime>0&&(e=d.requestTime),d.firstPaintTime>=e&&(c=1e3*(d.firstPaintTime-e)))),void 0===c||0>c||c>12e4&&c>b?b:c):0},getDomInteractive:function(){return K?E.timing.domInteractive-N:0},getNow:function(){return K?E.now():0},getQueryStrings:function(){var b={},c="",d=a.location.search.slice(1).split("&"),e=0,f=d.length||0;for(e=0;f>e;e+=1)c=d[e].split("="),b[c[0]]=c[1]||"";return b},getViewport:function(){return F},getVersion:function(){return I},logToConsole:function(a){K&&M&&console&&console.log&&console.log(a)},getModuleSelector:function(a){for(var b=[],c=0,d=Q.whiteListedContainerElements.length;d>c;c++)b.push(Q.whiteListedContainerElements[c]+'[id^="'+a+'"]');return b.push('*[data-yaft-module^="'+a+'"]'),b.join(",")},getModuleName:function(a){return a.id||a.getAttribute("data-yaft-module")||void 0},getElemResourceUrl:function(a){var b,c="",d=[];return"VIDEO"===a.nodeName||(a.src?c=a.src:(b=a.currentStyle||window.getComputedStyle(a,!1),b&&b.backgroundImage&&(d=b.backgroundImage.match(/url\((["']{0,1})([^'"]+)\1\)$/),d&&3===d.length&&(c=d[2])))),c}}}}(window,document),"undefined"!=typeof module&&module.exports&&("undefined"!=typeof window?module.exports=window.YAFT:module.exports=!1);